import{g as P,S as xs,a as Es,R as As,T as ys,b as Je,c as $t,L as ws,d as le,F as Yt,M as F,V as j,C as V,e as Rs,P as Ss,D as Qt,f as Se,h as ee,I as bs,Q as Zt,i as _s,O as Jt,j as Bn,k as Ms,B as we,l as Cs,m as en,N as Ls,n as Is,o as Ns,p as W,q as dt,r as be,s as Ps,t as et,u as Os,v as Re,w as Ds,x as tn,y as Xe,z as re,A as Fs,E as nn,G as ks,H as yt,J as Bs,K as Hs,U as Gs,W as Us,X as qe,Y as wt,Z as js,_ as Rt,$ as Vs,a0 as zs,a1 as Ks,a2 as Xs,a3 as sn,a4 as Ws,a5 as Ge,a6 as Ot,a7 as Dt,a8 as Ft,a9 as Hn,aa as qs,ab as $s,ac as Ys,ad as kt,ae as K,af as br,ag as _r,ah as Mr,ai as Cr,aj as St,ak as rn,al as pt,am as Mt,an as tt,ao as Qs,ap as te,aq as Zs,ar as Gn,as as B,at as Lr,au as Js,av as er,aw as Un,ax as tr,ay as qn,az as Ir,aA as wn,aB as $n,aC as nr,aD as Nr,aE as Pr,aF as Or,aG as Dr,aH as Fr,aI as kr,aJ as Br,aK as Hr,aL as Gr,aM as Ur,aN as jr,aO as Yn,aP as Qn,aQ as Vr,aR as zr}from"./menu-DAg-UDe3.js";function Kr(o,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(o,typeof(s=(function(r,i){if(typeof r!="object"||r===null)return r;var c=r[Symbol.toPrimitive];if(c!==void 0){var a=c.call(r,"string");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)})(n.key))=="symbol"?s:String(s),n)}var s}function jn(o,e,t){return e&&Kr(o.prototype,e),Object.defineProperty(o,"prototype",{writable:!1}),o}function ie(){return ie=Object.assign?Object.assign.bind():function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},ie.apply(this,arguments)}function on(o,e){o.prototype=Object.create(e.prototype),o.prototype.constructor=o,mt(o,e)}function Rn(o){return Rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rn(o)}function mt(o,e){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},mt(o,e)}function Xr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sn(o,e,t){return Sn=Xr()?Reflect.construct.bind():function(n,s,r){var i=[null];i.push.apply(i,s);var c=new(Function.bind.apply(n,i));return r&&mt(c,r.prototype),c},Sn.apply(null,arguments)}function bn(o){var e=typeof Map=="function"?new Map:void 0;return bn=function(t){if(t===null||Function.toString.call(t).indexOf("[native code]")===-1)return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Sn(t,arguments,Rn(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),mt(n,t)},bn(o)}function Wr(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}var Ee,qr=function(){this.before=void 0,this.beforeLeave=void 0,this.leave=void 0,this.afterLeave=void 0,this.beforeEnter=void 0,this.enter=void 0,this.afterEnter=void 0,this.after=void 0};(function(o){o[o.off=0]="off",o[o.error=1]="error",o[o.warning=2]="warning",o[o.info=3]="info",o[o.debug=4]="debug"})(Ee||(Ee={}));var Zn=Ee.off,De=(function(){function o(t){this.t=void 0,this.t=t}o.getLevel=function(){return Zn},o.setLevel=function(t){return Zn=Ee[t]};var e=o.prototype;return e.error=function(){this.i(console.error,Ee.error,[].slice.call(arguments))},e.warn=function(){this.i(console.warn,Ee.warning,[].slice.call(arguments))},e.info=function(){this.i(console.info,Ee.info,[].slice.call(arguments))},e.debug=function(){this.i(console.log,Ee.debug,[].slice.call(arguments))},e.i=function(t,n,s){n<=o.getLevel()&&t.apply(console,["["+this.t+"] "].concat(s))},o})();function je(o){return o.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function Jn(o){return o&&o.sensitive?"":"i"}var ue={container:"container",history:"history",namespace:"namespace",prefix:"data-barba",prevent:"prevent",wrapper:"wrapper"},Fe=new((function(){function o(){this.o=ue,this.u=void 0,this.h={after:null,before:null,parent:null}}var e=o.prototype;return e.toString=function(t){return t.outerHTML},e.toDocument=function(t){return this.u||(this.u=new DOMParser),this.u.parseFromString(t,"text/html")},e.toElement=function(t){var n=document.createElement("div");return n.innerHTML=t,n},e.getHtml=function(t){return t===void 0&&(t=document),this.toString(t.documentElement)},e.getWrapper=function(t){return t===void 0&&(t=document),t.querySelector("["+this.o.prefix+'="'+this.o.wrapper+'"]')},e.getContainer=function(t){return t===void 0&&(t=document),t.querySelector("["+this.o.prefix+'="'+this.o.container+'"]')},e.removeContainer=function(t){document.body.contains(t)&&(this.v(t),t.parentNode.removeChild(t))},e.addContainer=function(t,n){var s=this.getContainer()||this.h.before;s?this.l(t,s):this.h.after?this.h.after.parentNode.insertBefore(t,this.h.after):this.h.parent?this.h.parent.appendChild(t):n.appendChild(t)},e.getSibling=function(){return this.h},e.getNamespace=function(t){t===void 0&&(t=document);var n=t.querySelector("["+this.o.prefix+"-"+this.o.namespace+"]");return n?n.getAttribute(this.o.prefix+"-"+this.o.namespace):null},e.getHref=function(t){if(t.tagName&&t.tagName.toLowerCase()==="a"){if(typeof t.href=="string")return t.href;var n=t.getAttribute("href")||t.getAttribute("xlink:href");if(n)return this.resolveUrl(n.baseVal||n)}return null},e.resolveUrl=function(){var t=[].slice.call(arguments).length;if(t===0)throw new Error("resolveUrl requires at least one argument; got none.");var n=document.createElement("base");if(n.href=arguments[0],t===1)return n.href;var s=document.getElementsByTagName("head")[0];s.insertBefore(n,s.firstChild);for(var r,i=document.createElement("a"),c=1;c<t;c++)i.href=arguments[c],n.href=r=i.href;return s.removeChild(n),r},e.l=function(t,n){n.parentNode.insertBefore(t,n.nextSibling)},e.v=function(t){return this.h={after:t.nextElementSibling,before:t.previousElementSibling,parent:t.parentElement},this.h},o})()),$r=(function(){function o(){this.p=void 0,this.m=[],this.P=-1}var e=o.prototype;return e.init=function(t,n){this.p="barba";var s={data:{},ns:n,scroll:{x:window.scrollX,y:window.scrollY},url:t};this.P=0,this.m.push(s);var r={from:this.p,index:this.P,states:[].concat(this.m)};window.history&&window.history.replaceState(r,"",t)},e.change=function(t,n,s){if(s&&s.state){var r=s.state,i=r.index;n=this.g(this.P-i),this.replace(r.states),this.P=i}else this.add(t,n);return n},e.add=function(t,n,s,r){var i=s??this.R(n),c={data:r??{},ns:"tmp",scroll:{x:window.scrollX,y:window.scrollY},url:t};switch(i){case"push":this.P=this.size,this.m.push(c);break;case"replace":this.set(this.P,c)}var a={from:this.p,index:this.P,states:[].concat(this.m)};switch(i){case"push":window.history&&window.history.pushState(a,"",t);break;case"replace":window.history&&window.history.replaceState(a,"",t)}},e.store=function(t,n){var s=n||this.P,r=this.get(s);r.data=ie({},r.data,t),this.set(s,r);var i={from:this.p,index:this.P,states:[].concat(this.m)};window.history.replaceState(i,"")},e.update=function(t,n){var s=n||this.P,r=ie({},this.get(s),t);this.set(s,r)},e.remove=function(t){t?this.m.splice(t,1):this.m.pop(),this.P--},e.clear=function(){this.m=[],this.P=-1},e.replace=function(t){this.m=t},e.get=function(t){return this.m[t]},e.set=function(t,n){return this.m[t]=n},e.R=function(t){var n="push",s=t,r=ue.prefix+"-"+ue.history;return s.hasAttribute&&s.hasAttribute(r)&&(n=s.getAttribute(r)),n},e.g=function(t){return Math.abs(t)>1?t>0?"forward":"back":t===0?"popstate":t>0?"back":"forward"},jn(o,[{key:"current",get:function(){return this.m[this.P]}},{key:"previous",get:function(){return this.P<1?null:this.m[this.P-1]}},{key:"size",get:function(){return this.m.length}}]),o})(),sr=new $r,Bt=function(o,e){try{var t=(function(){if(!e.next.html)return Promise.resolve(o).then(function(n){var s=e.next;if(n){var r=Fe.toElement(n.html);s.namespace=Fe.getNamespace(r),s.container=Fe.getContainer(r),s.url=n.url,s.html=n.html,sr.update({ns:s.namespace});var i=Fe.toDocument(n.html);document.title=i.title}})})();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(n){return Promise.reject(n)}},rr=function o(e,t,n){return e instanceof RegExp?(function(s,r){if(!r)return s;for(var i=/\((?:\?<(.*?)>)?(?!\?)/g,c=0,a=i.exec(s.source);a;)r.push({name:a[1]||c++,prefix:"",suffix:"",modifier:"",pattern:""}),a=i.exec(s.source);return s})(e,t):Array.isArray(e)?(function(s,r,i){var c=s.map(function(a){return o(a,r,i).source});return new RegExp("(?:".concat(c.join("|"),")"),Jn(i))})(e,t,n):(function(s,r,i){return(function(c,a,l){l===void 0&&(l={});for(var h=l.strict,u=h!==void 0&&h,f=l.start,d=f===void 0||f,p=l.end,g=p===void 0||p,m=l.encode,v=m===void 0?function(it){return it}:m,T=l.delimiter,E=T===void 0?"/#?":T,x=l.endsWith,b="[".concat(je(x===void 0?"":x),"]|$"),L="[".concat(je(E),"]"),A=d?"^":"",O=0,I=c;O<I.length;O++){var y=I[O];if(typeof y=="string")A+=je(v(y));else{var H=je(v(y.prefix)),_=je(v(y.suffix));if(y.pattern)if(a&&a.push(y),H||_)if(y.modifier==="+"||y.modifier==="*"){var G=y.modifier==="*"?"?":"";A+="(?:".concat(H,"((?:").concat(y.pattern,")(?:").concat(_).concat(H,"(?:").concat(y.pattern,"))*)").concat(_,")").concat(G)}else A+="(?:".concat(H,"(").concat(y.pattern,")").concat(_,")").concat(y.modifier);else A+=y.modifier==="+"||y.modifier==="*"?"((?:".concat(y.pattern,")").concat(y.modifier,")"):"(".concat(y.pattern,")").concat(y.modifier);else A+="(?:".concat(H).concat(_,")").concat(y.modifier)}}if(g)u||(A+="".concat(L,"?")),A+=l.endsWith?"(?=".concat(b,")"):"$";else{var C=c[c.length-1],$=typeof C=="string"?L.indexOf(C[C.length-1])>-1:C===void 0;u||(A+="(?:".concat(L,"(?=").concat(b,"))?")),$||(A+="(?=".concat(L,"|").concat(b,")"))}return new RegExp(A,Jn(l))})((function(c,a){a===void 0&&(a={});for(var l=(function(_){for(var G=[],C=0;C<_.length;){var $=_[C];if($!=="*"&&$!=="+"&&$!=="?")if($!=="\\")if($!=="{")if($!=="}")if($!==":")if($!=="(")G.push({type:"CHAR",index:C,value:_[C++]});else{var it=1,_t="";if(_[U=C+1]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(U));for(;U<_.length;)if(_[U]!=="\\"){if(_[U]===")"){if(--it==0){U++;break}}else if(_[U]==="("&&(it++,_[U+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(U));_t+=_[U++]}else _t+=_[U++]+_[U++];if(it)throw new TypeError("Unbalanced pattern at ".concat(C));if(!_t)throw new TypeError("Missing pattern at ".concat(C));G.push({type:"PATTERN",index:C,value:_t}),C=U}else{for(var ln="",U=C+1;U<_.length;){var Ce=_.charCodeAt(U);if(!(Ce>=48&&Ce<=57||Ce>=65&&Ce<=90||Ce>=97&&Ce<=122||Ce===95))break;ln+=_[U++]}if(!ln)throw new TypeError("Missing parameter name at ".concat(C));G.push({type:"NAME",index:C,value:ln}),C=U}else G.push({type:"CLOSE",index:C,value:_[C++]});else G.push({type:"OPEN",index:C,value:_[C++]});else G.push({type:"ESCAPED_CHAR",index:C++,value:_[C++]});else G.push({type:"MODIFIER",index:C,value:_[C++]})}return G.push({type:"END",index:C,value:""}),G})(c),h=a.prefixes,u=h===void 0?"./":h,f="[^".concat(je(a.delimiter||"/#?"),"]+?"),d=[],p=0,g=0,m="",v=function(_){if(g<l.length&&l[g].type===_)return l[g++].value},T=function(_){var G=v(_);if(G!==void 0)return G;var C=l[g],$=C.index;throw new TypeError("Unexpected ".concat(C.type," at ").concat($,", expected ").concat(_))},E=function(){for(var _,G="";_=v("CHAR")||v("ESCAPED_CHAR");)G+=_;return G};g<l.length;){var x=v("CHAR"),b=v("NAME"),L=v("PATTERN");if(b||L)u.indexOf(O=x||"")===-1&&(m+=O,O=""),m&&(d.push(m),m=""),d.push({name:b||p++,prefix:O,suffix:"",pattern:L||f,modifier:v("MODIFIER")||""});else{var A=x||v("ESCAPED_CHAR");if(A)m+=A;else if(m&&(d.push(m),m=""),v("OPEN")){var O=E(),I=v("NAME")||"",y=v("PATTERN")||"",H=E();T("CLOSE"),d.push({name:I||(y?p++:""),pattern:I&&!y?f:y,prefix:O,suffix:H,modifier:v("MODIFIER")||""})}else T("END")}}return d})(s,i),r,i)})(e,t,n)},Yr={__proto__:null,update:Bt,nextTick:function(){return new Promise(function(o){window.requestAnimationFrame(o)})},pathToRegexp:rr},ir=function(){return window.location.origin},gt=function(o){return o===void 0&&(o=window.location.href),Ae(o).port},Ae=function(o){var e,t=o.match(/:\d+/);if(t===null)/^http/.test(o)&&(e=80),/^https/.test(o)&&(e=443);else{var n=t[0].substring(1);e=parseInt(n,10)}var s,r=o.replace(ir(),""),i={},c=r.indexOf("#");c>=0&&(s=r.slice(c+1),r=r.slice(0,c));var a=r.indexOf("?");return a>=0&&(i=or(r.slice(a+1)),r=r.slice(0,a)),{hash:s,path:r,port:e,query:i}},or=function(o){return o.split("&").reduce(function(e,t){var n=t.split("=");return e[n[0]]=n[1],e},{})},_n=function(o){return o===void 0&&(o=window.location.href),o.replace(/(\/#.*|\/|#.*)$/,"")},Qr={__proto__:null,getHref:function(){return window.location.href},getAbsoluteHref:function(o,e){return e===void 0&&(e=document.baseURI),new URL(o,e).href},getOrigin:ir,getPort:gt,getPath:function(o){return o===void 0&&(o=window.location.href),Ae(o).path},getQuery:function(o,e){return e===void 0&&(e=!1),e?JSON.stringify(Ae(o).query):Ae(o).query},getHash:function(o){return Ae(o).hash},parse:Ae,parseQuery:or,clean:_n};function Zr(o,e,t,n,s){return e===void 0&&(e=2e3),new Promise(function(r,i){var c=new XMLHttpRequest;c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE){if(c.status===200){var a=c.responseURL!==""&&c.responseURL!==o?c.responseURL:o;r({html:c.responseText,url:ie({href:a},Ae(a))}),n.update(o,{status:"fulfilled",target:a})}else if(c.status){var l={status:c.status,statusText:c.statusText};t(o,l),i(l),n.update(o,{status:"rejected"})}}},c.ontimeout=function(){var a=new Error("Timeout error ["+e+"]");t(o,a),i(a),n.update(o,{status:"rejected"})},c.onerror=function(){var a=new Error("Fetch error");t(o,a),i(a),n.update(o,{status:"rejected"})},c.open("GET",o),c.timeout=e,c.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml"),c.setRequestHeader("x-barba","yes"),s.all().forEach(function(a,l){c.setRequestHeader(l,a)}),c.send()})}function Jr(o){return!!o&&(typeof o=="object"||typeof o=="function")&&typeof o.then=="function"}function We(o,e){return e===void 0&&(e={}),function(){var t=arguments,n=!1,s=new Promise(function(r,i){e.async=function(){return n=!0,function(a,l){a?i(a):r(l)}};var c=o.apply(e,[].slice.call(t));n||(Jr(c)?c.then(r,i):r(c))});return s}}var Te=new((function(o){function e(){var n;return(n=o.call(this)||this).logger=new De("@barba/core"),n.all=["ready","page","reset","currentAdded","currentRemoved","nextAdded","nextRemoved","beforeOnce","once","afterOnce","before","beforeLeave","leave","afterLeave","beforeEnter","enter","afterEnter","after"],n.registered=new Map,n.init(),n}on(e,o);var t=e.prototype;return t.init=function(){var n=this;this.registered.clear(),this.all.forEach(function(s){n[s]||(n[s]=function(r,i){n.registered.has(s)||n.registered.set(s,new Set),n.registered.get(s).add({ctx:i||{},fn:r})})})},t.do=function(n){var s=arguments,r=this;if(this.registered.has(n)){var i=Promise.resolve();return this.registered.get(n).forEach(function(c){i=i.then(function(){return We(c.fn,c.ctx).apply(void 0,[].slice.call(s,1))})}),i.catch(function(c){r.logger.debug("Hook error ["+n+"]"),r.logger.error(c)})}return Promise.resolve()},t.clear=function(){var n=this;this.all.forEach(function(s){delete n[s]}),this.init()},t.help=function(){this.logger.info("Available hooks: "+this.all.join(","));var n=[];this.registered.forEach(function(s,r){return n.push(r)}),this.logger.info("Registered hooks: "+n.join(","))},e})(qr)),ar=(function(){function o(e){if(this.k=void 0,this.O=[],typeof e=="boolean")this.k=e;else{var t=Array.isArray(e)?e:[e];this.O=t.map(function(n){return rr(n)})}}return o.prototype.checkHref=function(e){if(typeof this.k=="boolean")return this.k;var t=Ae(e).path;return this.O.some(function(n){return n.exec(t)!==null})},o})(),ei=(function(o){function e(n){var s;return(s=o.call(this,n)||this).T=new Map,s}on(e,o);var t=e.prototype;return t.set=function(n,s,r,i,c){return this.T.set(n,{action:r,request:s,status:i,target:c??n}),{action:r,request:s,status:i,target:c}},t.get=function(n){return this.T.get(n)},t.getRequest=function(n){return this.T.get(n).request},t.getAction=function(n){return this.T.get(n).action},t.getStatus=function(n){return this.T.get(n).status},t.getTarget=function(n){return this.T.get(n).target},t.has=function(n){return!this.checkHref(n)&&this.T.has(n)},t.delete=function(n){return this.T.delete(n)},t.update=function(n,s){var r=ie({},this.T.get(n),s);return this.T.set(n,r),r},e})(ar),ti=(function(){function o(){this.A=new Map}var e=o.prototype;return e.set=function(t,n){return this.A.set(t,n),{name:n}},e.get=function(t){return this.A.get(t)},e.all=function(){return this.A},e.has=function(t){return this.A.has(t)},e.delete=function(t){return this.A.delete(t)},e.clear=function(){return this.A.clear()},o})(),ni=function(){return!window.history.pushState},si=function(o){return!o.el||!o.href},ri=function(o){var e=o.event;return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey},ii=function(o){var e=o.el;return e.hasAttribute("target")&&e.target==="_blank"},oi=function(o){var e=o.el;return e.protocol!==void 0&&window.location.protocol!==e.protocol||e.hostname!==void 0&&window.location.hostname!==e.hostname},ai=function(o){var e=o.el;return e.port!==void 0&&gt()!==gt(e.href)},ci=function(o){var e=o.el;return e.getAttribute&&typeof e.getAttribute("download")=="string"},li=function(o){return o.el.hasAttribute(ue.prefix+"-"+ue.prevent)},ui=function(o){return!!o.el.closest("["+ue.prefix+"-"+ue.prevent+'="all"]')},hi=function(o){var e=o.href;return _n(e)===_n()&&gt(e)===gt()},fi=(function(o){function e(n){var s;return(s=o.call(this,n)||this).suite=[],s.tests=new Map,s.init(),s}on(e,o);var t=e.prototype;return t.init=function(){this.add("pushState",ni),this.add("exists",si),this.add("newTab",ri),this.add("blank",ii),this.add("corsDomain",oi),this.add("corsPort",ai),this.add("download",ci),this.add("preventSelf",li),this.add("preventAll",ui),this.add("sameUrl",hi,!1)},t.add=function(n,s,r){r===void 0&&(r=!0),this.tests.set(n,s),r&&this.suite.push(n)},t.run=function(n,s,r,i){return this.tests.get(n)({el:s,event:r,href:i})},t.checkLink=function(n,s,r){var i=this;return this.suite.some(function(c){return i.run(c,n,s,r)})},e})(ar),un=(function(o){function e(t,n){var s;return n===void 0&&(n="Barba error"),(s=o.call.apply(o,[this].concat([].slice.call(arguments,2)))||this).error=void 0,s.label=void 0,s.error=t,s.label=n,Error.captureStackTrace&&Error.captureStackTrace(Wr(s),e),s.name="BarbaError",s}return on(e,o),e})(bn(Error)),di=(function(){function o(t){t===void 0&&(t=[]),this.logger=new De("@barba/core"),this.all=[],this.page=[],this.once=[],this.j=[{name:"namespace",type:"strings"},{name:"custom",type:"function"}],t&&(this.all=this.all.concat(t)),this.update()}var e=o.prototype;return e.add=function(t,n){t==="rule"?this.j.splice(n.position||0,0,n.value):this.all.push(n),this.update()},e.resolve=function(t,n){var s=this;n===void 0&&(n={});var r=n.once?this.once:this.page;r=r.filter(n.self?function(f){return f.name&&f.name==="self"}:function(f){return!f.name||f.name!=="self"});var i=new Map,c=r.find(function(f){var d=!0,p={};return n.self&&f.name==="self"?(i.set(f,p),!0):(s.j.reverse().forEach(function(g){d&&(d=s.M(f,g,t,p),f.from&&f.to&&(d=s.M(f,g,t,p,"from")&&s.M(f,g,t,p,"to")),f.from&&!f.to&&(d=s.M(f,g,t,p,"from")),!f.from&&f.to&&(d=s.M(f,g,t,p,"to")))}),i.set(f,p),d)}),a=i.get(c),l=[];if(l.push(n.once?"once":"page"),n.self&&l.push("self"),a){var h,u=[c];Object.keys(a).length>0&&u.push(a),(h=this.logger).info.apply(h,["Transition found ["+l.join(",")+"]"].concat(u))}else this.logger.info("No transition found ["+l.join(",")+"]");return c},e.update=function(){var t=this;this.all=this.all.map(function(n){return t.N(n)}).sort(function(n,s){return n.priority-s.priority}).reverse().map(function(n){return delete n.priority,n}),this.page=this.all.filter(function(n){return n.leave!==void 0||n.enter!==void 0}),this.once=this.all.filter(function(n){return n.once!==void 0})},e.M=function(t,n,s,r,i){var c=!0,a=!1,l=t,h=n.name,u=h,f=h,d=h,p=i?l[i]:l,g=i==="to"?s.next:s.current;if(i?p&&p[h]:p[h]){switch(n.type){case"strings":default:var m=Array.isArray(p[u])?p[u]:[p[u]];g[u]&&m.indexOf(g[u])!==-1&&(a=!0),m.indexOf(g[u])===-1&&(c=!1);break;case"object":var v=Array.isArray(p[f])?p[f]:[p[f]];g[f]?(g[f].name&&v.indexOf(g[f].name)!==-1&&(a=!0),v.indexOf(g[f].name)===-1&&(c=!1)):c=!1;break;case"function":p[d](s)?a=!0:c=!1}a&&(i?(r[i]=r[i]||{},r[i][h]=l[i][h]):r[h]=l[h])}return c},e.S=function(t,n,s){var r=0;return(t[n]||t.from&&t.from[n]||t.to&&t.to[n])&&(r+=Math.pow(10,s),t.from&&t.from[n]&&(r+=1),t.to&&t.to[n]&&(r+=2)),r},e.N=function(t){var n=this;t.priority=0;var s=0;return this.j.forEach(function(r,i){s+=n.S(t,r.name,i+1)}),t.priority=s,t},o})();function ot(o,e){try{var t=o()}catch(n){return e(n)}return t&&t.then?t.then(void 0,e):t}var pi=(function(){function o(t){t===void 0&&(t=[]),this.logger=new De("@barba/core"),this.store=void 0,this.C=!1,this.store=new di(t)}var e=o.prototype;return e.get=function(t,n){return this.store.resolve(t,n)},e.doOnce=function(t){var n=t.data,s=t.transition;try{var r=function(){i.C=!1},i=this,c=s||{};i.C=!0;var a=ot(function(){return Promise.resolve(i.L("beforeOnce",n,c)).then(function(){return Promise.resolve(i.once(n,c)).then(function(){return Promise.resolve(i.L("afterOnce",n,c)).then(function(){})})})},function(l){i.C=!1,i.logger.debug("Transition error [before/after/once]"),i.logger.error(l)});return Promise.resolve(a&&a.then?a.then(r):r())}catch(l){return Promise.reject(l)}},e.doPage=function(t){var n=t.data,s=t.transition,r=t.page,i=t.wrapper;try{var c=function(f){a.C=!1},a=this,l=s||{},h=l.sync===!0||!1;a.C=!0;var u=ot(function(){function f(){return Promise.resolve(a.L("before",n,l)).then(function(){function p(m){return Promise.resolve(a.remove(n)).then(function(){return Promise.resolve(a.L("after",n,l)).then(function(){})})}var g=(function(){if(h)return ot(function(){return Promise.resolve(a.add(n,i)).then(function(){return Promise.resolve(a.L("beforeLeave",n,l)).then(function(){return Promise.resolve(a.L("beforeEnter",n,l)).then(function(){return Promise.resolve(Promise.all([a.leave(n,l),a.enter(n,l)])).then(function(){return Promise.resolve(a.L("afterLeave",n,l)).then(function(){return Promise.resolve(a.L("afterEnter",n,l)).then(function(){})})})})})})},function(E){if(a.H(E))throw new un(E,"Transition error [sync]")});var m=function(E){return ot(function(){var x=(function(){if(v!==!1)return Promise.resolve(a.add(n,i)).then(function(){return Promise.resolve(a.L("beforeEnter",n,l)).then(function(){return Promise.resolve(a.enter(n,l,v)).then(function(){return Promise.resolve(a.L("afterEnter",n,l)).then(function(){})})})})})();if(x&&x.then)return x.then(function(){})},function(x){if(a.H(x))throw new un(x,"Transition error [before/after/enter]")})},v=!1,T=ot(function(){return Promise.resolve(a.L("beforeLeave",n,l)).then(function(){return Promise.resolve(Promise.all([a.leave(n,l),Bt(r,n)]).then(function(E){return E[0]})).then(function(E){return v=E,Promise.resolve(a.L("afterLeave",n,l)).then(function(){})})})},function(E){if(a.H(E))throw new un(E,"Transition error [before/after/leave]")});return T&&T.then?T.then(m):m()})();return g&&g.then?g.then(p):p()})}var d=(function(){if(h)return Promise.resolve(Bt(r,n)).then(function(){})})();return d&&d.then?d.then(f):f()},function(f){throw a.C=!1,f.name&&f.name==="BarbaError"?(a.logger.debug(f.label),a.logger.error(f.error),f):(a.logger.debug("Transition error [page]"),a.logger.error(f),f)});return Promise.resolve(u&&u.then?u.then(c):c())}catch(f){return Promise.reject(f)}},e.once=function(t,n){try{return Promise.resolve(Te.do("once",t,n)).then(function(){return n.once?We(n.once,n)(t):Promise.resolve()})}catch(s){return Promise.reject(s)}},e.leave=function(t,n){try{return Promise.resolve(Te.do("leave",t,n)).then(function(){return n.leave?We(n.leave,n)(t):Promise.resolve()})}catch(s){return Promise.reject(s)}},e.enter=function(t,n,s){try{return Promise.resolve(Te.do("enter",t,n)).then(function(){return n.enter?We(n.enter,n)(t,s):Promise.resolve()})}catch(r){return Promise.reject(r)}},e.add=function(t,n){try{return Fe.addContainer(t.next.container,n),Te.do("nextAdded",t),Promise.resolve()}catch(s){return Promise.reject(s)}},e.remove=function(t){try{return Fe.removeContainer(t.current.container),Te.do("currentRemoved",t),Promise.resolve()}catch(n){return Promise.reject(n)}},e.H=function(t){return t.message?!/Timeout error|Fetch error/.test(t.message):!t.status},e.L=function(t,n,s){try{return Promise.resolve(Te.do(t,n,s)).then(function(){return s[t]?We(s[t],s)(n):Promise.resolve()})}catch(r){return Promise.reject(r)}},jn(o,[{key:"isRunning",get:function(){return this.C},set:function(t){this.C=t}},{key:"hasOnce",get:function(){return this.store.once.length>0}},{key:"hasSelf",get:function(){return this.store.all.some(function(t){return t.name==="self"})}},{key:"shouldWait",get:function(){return this.store.all.some(function(t){return t.to&&!t.to.route||t.sync})}}]),o})(),mi=(function(){function o(e){var t=this;this.names=["beforeLeave","afterLeave","beforeEnter","afterEnter"],this.byNamespace=new Map,e.length!==0&&(e.forEach(function(n){t.byNamespace.set(n.namespace,n)}),this.names.forEach(function(n){Te[n](t._(n))}))}return o.prototype._=function(e){var t=this;return function(n){var s=e.match(/enter/i)?n.next:n.current,r=t.byNamespace.get(s.namespace);return r&&r[e]?We(r[e],r)(n):Promise.resolve()}},o})();Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(o){var e=this;do{if(e.matches(o))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1);return null});var gi={container:null,html:"",namespace:"",url:{hash:"",href:"",path:"",port:null,query:{}}},Vn=new((function(){function o(){this.version="2.10.3",this.schemaPage=gi,this.Logger=De,this.logger=new De("@barba/core"),this.plugins=[],this.timeout=void 0,this.cacheIgnore=void 0,this.cacheFirstPage=void 0,this.prefetchIgnore=void 0,this.preventRunning=void 0,this.hooks=Te,this.cache=void 0,this.headers=void 0,this.prevent=void 0,this.transitions=void 0,this.views=void 0,this.dom=Fe,this.helpers=Yr,this.history=sr,this.request=Zr,this.url=Qr,this.D=void 0,this.B=void 0,this.q=void 0,this.F=void 0}var e=o.prototype;return e.use=function(t,n){var s=this.plugins;s.indexOf(t)>-1?this.logger.warn("Plugin ["+t.name+"] already installed."):typeof t.install=="function"?(t.install(this,n),s.push(t)):this.logger.warn("Plugin ["+t.name+'] has no "install" method.')},e.init=function(t){var n=t===void 0?{}:t,s=n.transitions,r=s===void 0?[]:s,i=n.views,c=i===void 0?[]:i,a=n.schema,l=a===void 0?ue:a,h=n.requestError,u=n.timeout,f=u===void 0?2e3:u,d=n.cacheIgnore,p=d!==void 0&&d,g=n.cacheFirstPage,m=g!==void 0&&g,v=n.prefetchIgnore,T=v!==void 0&&v,E=n.preventRunning,x=E!==void 0&&E,b=n.prevent,L=b===void 0?null:b,A=n.debug,O=n.logLevel;if(De.setLevel((A!==void 0&&A)===!0?"debug":O===void 0?"off":O),this.logger.info(this.version),Object.keys(l).forEach(function(H){ue[H]&&(ue[H]=l[H])}),this.B=h,this.timeout=f,this.cacheIgnore=p,this.cacheFirstPage=m,this.prefetchIgnore=T,this.preventRunning=x,this.q=this.dom.getWrapper(),!this.q)throw new Error("[@barba/core] No Barba wrapper found");this.I();var I=this.data.current;if(!I.container)throw new Error("[@barba/core] No Barba container found");if(this.cache=new ei(p),this.headers=new ti,this.prevent=new fi(T),this.transitions=new pi(r),this.views=new mi(c),L!==null){if(typeof L!="function")throw new Error("[@barba/core] Prevent should be a function");this.prevent.add("preventCustom",L)}this.history.init(I.url.href,I.namespace),m&&this.cache.set(I.url.href,Promise.resolve({html:I.html,url:I.url}),"init","fulfilled"),this.U=this.U.bind(this),this.$=this.$.bind(this),this.X=this.X.bind(this),this.G(),this.plugins.forEach(function(H){return H.init()});var y=this.data;y.trigger="barba",y.next=y.current,y.current=ie({},this.schemaPage),this.hooks.do("ready",y),this.once(y),this.I()},e.destroy=function(){this.I(),this.J(),this.history.clear(),this.hooks.clear(),this.plugins=[]},e.force=function(t){window.location.assign(t)},e.go=function(t,n,s){var r;if(n===void 0&&(n="barba"),this.F=null,this.transitions.isRunning)this.force(t);else if(!(r=n==="popstate"?this.history.current&&this.url.getPath(this.history.current.url)===this.url.getPath(t)&&this.url.getQuery(this.history.current.url,!0)===this.url.getQuery(t,!0):this.prevent.run("sameUrl",null,null,t))||this.transitions.hasSelf)return n=this.history.change(this.cache.has(t)?this.cache.get(t).target:t,n,s),s&&(s.stopPropagation(),s.preventDefault()),this.page(t,n,s??void 0,r)},e.once=function(t){try{var n=this;return Promise.resolve(n.hooks.do("beforeEnter",t)).then(function(){function s(){return Promise.resolve(n.hooks.do("afterEnter",t)).then(function(){})}var r=(function(){if(n.transitions.hasOnce){var i=n.transitions.get(t,{once:!0});return Promise.resolve(n.transitions.doOnce({transition:i,data:t})).then(function(){})}})();return r&&r.then?r.then(s):s()})}catch(s){return Promise.reject(s)}},e.page=function(t,n,s,r){try{var i,c=function(){var u=a.data;return Promise.resolve(a.hooks.do("page",u)).then(function(){var f=(function(d,p){try{var g=(m=a.transitions.get(u,{once:!1,self:r}),Promise.resolve(a.transitions.doPage({data:u,page:i,transition:m,wrapper:a.q})).then(function(){a.I()}))}catch{return p()}var m;return g&&g.then?g.then(void 0,p):g})(0,function(){De.getLevel()===0&&a.force(u.next.url.href)});if(f&&f.then)return f.then(function(){})})},a=this;if(a.data.next.url=ie({href:t},a.url.parse(t)),a.data.trigger=n,a.data.event=s,a.cache.has(t))i=a.cache.update(t,{action:"click"}).request;else{var l=a.request(t,a.timeout,a.onRequestError.bind(a,n),a.cache,a.headers);l.then(function(u){u.url.href!==t&&a.history.add(u.url.href,n,"replace")}),i=a.cache.set(t,l,"click","pending").request}var h=(function(){if(a.transitions.shouldWait)return Promise.resolve(Bt(i,a.data)).then(function(){})})();return Promise.resolve(h&&h.then?h.then(c):c())}catch(u){return Promise.reject(u)}},e.onRequestError=function(t){this.transitions.isRunning=!1;var n=[].slice.call(arguments,1),s=n[0],r=n[1],i=this.cache.getAction(s);return this.cache.delete(s),this.B&&this.B(t,i,s,r)===!1||i==="click"&&this.force(s),!1},e.prefetch=function(t){var n=this;t=this.url.getAbsoluteHref(t),this.cache.has(t)||this.cache.set(t,this.request(t,this.timeout,this.onRequestError.bind(this,"barba"),this.cache,this.headers).catch(function(s){n.logger.error(s)}),"prefetch","pending")},e.G=function(){this.prefetchIgnore!==!0&&(document.addEventListener("mouseover",this.U),document.addEventListener("touchstart",this.U)),document.addEventListener("click",this.$),window.addEventListener("popstate",this.X)},e.J=function(){this.prefetchIgnore!==!0&&(document.removeEventListener("mouseover",this.U),document.removeEventListener("touchstart",this.U)),document.removeEventListener("click",this.$),window.removeEventListener("popstate",this.X)},e.U=function(t){var n=this,s=this.W(t);if(s){var r=this.url.getAbsoluteHref(this.dom.getHref(s));this.prevent.checkHref(r)||this.cache.has(r)||this.cache.set(r,this.request(r,this.timeout,this.onRequestError.bind(this,s),this.cache,this.headers).catch(function(i){n.logger.error(i)}),"enter","pending")}},e.$=function(t){var n=this.W(t);if(n){if(this.transitions.isRunning&&this.preventRunning)return t.preventDefault(),void t.stopPropagation();this.F=t,this.go(this.dom.getHref(n),n,t)}},e.X=function(t){this.go(this.url.getHref(),"popstate",t)},e.W=function(t){for(var n=t.target;n&&!this.dom.getHref(n);)n=n.parentNode;if(n&&!this.prevent.checkLink(n,t,this.dom.getHref(n)))return n},e.I=function(){var t=this.url.getHref(),n={container:this.dom.getContainer(),html:this.dom.getHtml(),namespace:this.dom.getNamespace(),url:ie({href:t},this.url.parse(t))};this.D={current:n,event:void 0,next:ie({},this.schemaPage),trigger:void 0},this.hooks.do("reset",this.data)},jn(o,[{key:"data",get:function(){return this.D}},{key:"wrapper",get:function(){return this.q}}]),o})());P.registerPlugin(xs);class cr{constructor(e){this.galleryContainer=e,this.galleryItems=[],this.currentExpandedIndex=0,this.isMobile=!1,this.clickedItems=new Set,this.collapsedWidth=20,this.expandedWidth=400,this.mobileExpandedWidth=100,this.gap=5,this.init()}checkScreenSize(){const e=window.innerWidth<1e3,t=!this.isMobile;this.isMobile=e,(t&&this.isMobile||!t&&!this.isMobile)&&(this.createGallery(),this.setupEventListeners())}createGallery(){this.galleryContainer.innerHTML="",this.clickedItems.clear();const e=this.isMobile?10:20;for(let t=1;t<=e;t++){const n=document.createElement("div");n.className="spotlight-gallery-item";const s=document.createElement("img");s.src=`/spotlight/spotlight-${t}.jpg`,s.alt=`Spotlight ${t}`,n.appendChild(s),this.galleryContainer.appendChild(n)}this.galleryItems=this.galleryContainer.querySelectorAll(".spotlight-gallery-item"),this.currentExpandedIndex=0,this.updateGalleryLayout(this.currentExpandedIndex)}calculatePositions(e){const t=[],n=this.galleryItems.length,s=this.isMobile?this.mobileExpandedWidth:this.expandedWidth;let r=0;for(let l=0;l<n;l++)l===e?r+=s+this.gap:r+=this.collapsedWidth+this.gap;r-=this.gap;let a=(this.galleryContainer.offsetWidth-r)/2;for(let l=0;l<n;l++)l===e?(t.push({left:a,width:s}),a+=s+this.gap):(t.push({left:a,width:this.collapsedWidth}),a+=this.collapsedWidth+this.gap);return t}updateGalleryLayout(e){const t=this.calculatePositions(e);this.galleryItems.forEach((n,s)=>{const r=t[s];n.style.left=`${r.left}px`,n.style.width=`${r.width}px`})}handleDesktopEvents(){this.galleryItems.forEach((e,t)=>{e.addEventListener("mouseenter",()=>{this.currentExpandedIndex=t,this.updateGalleryLayout(this.currentExpandedIndex)})})}handleMobileEvents(){this.galleryItems.forEach((e,t)=>{e.addEventListener("click",()=>{if(this.clickedItems.has(t)&&this.currentExpandedIndex===t){this.clickedItems.delete(t);const n=this.clickedItems.size>0?Math.min(...this.clickedItems):0;this.currentExpandedIndex=n}else this.clickedItems.add(t),this.currentExpandedIndex=t;this.updateGalleryLayout(this.currentExpandedIndex)})})}removeEventListeners(){this.galleryItems.forEach(e=>{const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)}),this.galleryItems=this.galleryContainer.querySelectorAll(".spotlight-gallery-item")}setupEventListeners(){this.removeEventListeners(),this.isMobile?this.handleMobileEvents():this.handleDesktopEvents()}handleResize(){this.checkScreenSize(),setTimeout(()=>{this.updateGalleryLayout(this.currentExpandedIndex)},100)}init(){this.galleryContainer&&(this.checkScreenSize(),this.createGallery(),this.setupEventListeners(),window.addEventListener("resize",()=>this.handleResize()))}refresh(){this.createGallery(),this.setupEventListeners()}destroy(){this.removeEventListeners(),window.removeEventListener("resize",this.handleResize),this.galleryContainer.innerHTML=""}}function lr(){document.querySelectorAll(".spotlight-gallery").forEach(e=>{new cr(e)})}document.addEventListener("DOMContentLoaded",()=>{lr()});window.SpotlightGallery=cr;P.registerPlugin(xs,Es);const hn=new Map;function es(o){if(hn.has(o))return hn.get(o);const e=new Es(o,{type:"lines, words, chars"});return e.lines&&e.lines.forEach(t=>{t.style.overflow="hidden"}),hn.set(o,e),e}function ur(){P.matchMedia().add("(min-width: 992px)",()=>{const t=document.querySelectorAll("[data-animate='font-weight']"),n=300,s=800,r=400;t.forEach(i=>{const c=es(i),a=i.tagName.toLowerCase()==="a",l=a?c.chars:c.words;a&&P.set(l,{fontWeight:s}),i.addEventListener("mousemove",h=>{l.forEach(u=>{const f=u.getBoundingClientRect(),d=f.left+f.width/2,p=f.top+f.height/2,g=Math.hypot(d-h.clientX,p-h.clientY);let m;const v=s-r;a?g<n?m=r+g/n*v:m=s:g<n?m=s-g/n*v:m=r,P.to(u,{duration:.2,ease:"power1.out",fontWeight:m,overwrite:"auto"})})}),i.addEventListener("mouseleave",()=>{const h=a?s:r;l.forEach(u=>{P.to(u,{duration:.5,ease:"power2.out",fontWeight:h,overwrite:"auto"})})})})});const e=document.querySelector(".text-reveal");if(e){const t=es(e);P.fromTo(t.words,{y:-100,filter:"blur(5px)",opacity:0},{y:0,filter:"blur(0px)",opacity:1,duration:1,stagger:.05,ease:"power2.out",scrollTrigger:{trigger:e,start:"top 80%"}})}}document.addEventListener("DOMContentLoaded",()=>{ur()});const vt=[{title:"Blurred Vision",image:"/work/work-1.jpg",href:"/film.html"},{title:"Silent Motion",image:"/work/work-2.jpg",href:"/archive.html"},{title:"Red Mirage",image:"/work/work-3.jpg",href:"/about.html"},{title:"Echoed Silhouette",image:"/work/work-4.jpg",href:"/contact.html"}];let nt,ye,_e;const $e={passive:!1},zn=vt.length,st=zn*5,vi=5;let oe=window.innerWidth*.45,Kn=window.innerWidth/2,Tt=window.innerWidth<1e3,It=null,he=0,lt=0,ts;function Ti(){if(nt)for(let o=0;o<st*3;o++){const e=document.createElement("div");e.className="slide";const t=document.createElement("img"),n=vt[o%zn];t.src=n.image,e.appendChild(t),nt.appendChild(e)}}function hr(){if(_e)for(let o=0;o<st;o++){const e=o/st*Math.PI*2,t=Tt?150:350,n=Math.PI*1.5,s=t*Math.cos(n)+window.innerWidth/2,r=t*Math.sin(n)+window.innerHeight/2-25,i=document.createElement("div");i.className="thumbnail-item",i.dataset.index=o,i.dataset.angle=e,i.dataset.radius=t;const c=document.createElement("img"),a=vt[o%zn];c.src=a.image,i.appendChild(c),P.set(i,{x:s,y:r,angle:n,transformOrigin:"center center"}),_e.appendChild(i)}}function fr(){document.querySelectorAll(".slide").forEach((t,n)=>{const s=n*oe-oe;P.set(t,{x:s})});const e=window.innerWidth/2-oe/2;he=e,lt=e}function Ht(o){const e=o.deltaY||o.detail||o.wheelDelta*-1;lt-=e*1,clearTimeout(ts),ts=setTimeout(()=>{},150)}function dr(){he+=(lt-he)*.1;const o=st*oe;he>0?(he-=o,lt-=o):he<-o&&(he+=o,lt+=o);let e=0,t=1/0;document.querySelectorAll(".slide").forEach((i,c)=>{const a=c*oe+he;P.set(i,{x:a});const l=a+oe/2,h=Math.abs(l-Kn),u=oe*3,f=Math.min(h/u,1),p=1+(f<.5?2*f*f:1-Math.pow(-2*f+2,2)/2)*(vi-1),g=i.querySelector("img");P.set(g,{scale:p}),h<t&&(t=h,e=c%st)});const s=e%vt.length,r=vt[s];ye.textContent=r.title,ye.dataset.href=r.href||"",xi(),It=requestAnimationFrame(dr)}function xi(){const e=-(Math.abs(he)/oe*(360/st))+90;document.querySelectorAll(".thumbnail-item").forEach(n=>{const s=parseFloat(n.dataset.angle),r=Tt?150:350,i=s+e*Math.PI/180,c=r*Math.cos(i)+window.innerWidth/2,a=r*Math.sin(i)+window.innerHeight/2-25;P.set(n,{x:c,y:a,rotation:0,transformOrigin:"center center"})})}function pr(o){(o.target===document||o.target===document.body)&&window.scrollTo(0,0)}function mr(){Tt=window.innerWidth<1e3,oe=window.innerWidth*.45,Kn=window.innerWidth/2,_e&&(_e.innerHTML=""),hr(),fr()}function Ei(){window.addEventListener("wheel",Ht,$e),window.addEventListener("DOMMouseScroll",Ht,$e),window.addEventListener("scroll",pr,$e),window.addEventListener("resize",mr)}function Gt(){It&&(cancelAnimationFrame(It),It=null),window.removeEventListener("wheel",Ht,$e),window.removeEventListener("DOMMouseScroll",Ht,$e),window.removeEventListener("scroll",pr,$e),window.removeEventListener("resize",mr),ye&&(ye.onclick=null),nt&&(nt.innerHTML=""),_e&&(_e.innerHTML="")}function Ai(){if(Gt(),nt=document.querySelector(".slider"),ye=document.querySelector(".slide-title"),_e=document.querySelector(".thumbnail-wheel"),!nt||!ye||!_e)return;oe=window.innerWidth*.45,Kn=window.innerWidth/2,Tt=window.innerWidth<1e3,Ti(),hr(),document.querySelectorAll(".thumbnail-item").forEach((e,t)=>{P.to(e,{angle:parseFloat(e.dataset.angle),duration:1,ease:"power2.out",delay:t*.1,onUpdate:()=>{const n=P.getProperty(e,"angle"),s=Tt?150:350,r=s*Math.cos(n)+window.innerWidth/2,i=s*Math.sin(n)+window.innerHeight/2-25;P.set(e,{x:r,y:i})}})}),fr(),Ei(),ye.onclick=()=>{const e=ye.dataset.href;e&&(window.location.href=e)},dr()}const yi=parseInt(As.replace(/\D+/g,""));function ns(o,e){if(e===ys)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===Je||e===$t){let t=o.getIndex();if(t===null){const i=[],c=o.getAttribute("position");if(c!==void 0){for(let a=0;a<c.count;a++)i.push(a);o.setIndex(i),t=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}const n=t.count-2,s=[];if(t)if(e===Je)for(let i=1;i<=n;i++)s.push(t.getX(0)),s.push(t.getX(i)),s.push(t.getX(i+1));else for(let i=0;i<n;i++)i%2===0?(s.push(t.getX(i)),s.push(t.getX(i+1)),s.push(t.getX(i+2))):(s.push(t.getX(i+2)),s.push(t.getX(i+1)),s.push(t.getX(i)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=o.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}function Ut(o){if(typeof TextDecoder<"u")return new TextDecoder().decode(o);let e="";for(let t=0,n=o.length;t<n;t++)e+=String.fromCharCode(o[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const ke="srgb",pe="srgb-linear",ss=3001,wi=3e3;let Ri=class extends ws{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Ci(t)}),this.register(function(t){return new Li(t)}),this.register(function(t){return new Hi(t)}),this.register(function(t){return new Gi(t)}),this.register(function(t){return new Ui(t)}),this.register(function(t){return new Ni(t)}),this.register(function(t){return new Pi(t)}),this.register(function(t){return new Oi(t)}),this.register(function(t){return new Di(t)}),this.register(function(t){return new Mi(t)}),this.register(function(t){return new Fi(t)}),this.register(function(t){return new Ii(t)}),this.register(function(t){return new Bi(t)}),this.register(function(t){return new ki(t)}),this.register(function(t){return new bi(t)}),this.register(function(t){return new ji(t)}),this.register(function(t){return new Vi(t)})}load(e,t,n,s){const r=this;let i;if(this.resourcePath!=="")i=this.resourcePath;else if(this.path!==""){const l=le.extractUrlBase(e);i=le.resolveURL(l,this.path)}else i=le.extractUrlBase(e);this.manager.itemStart(e);const c=function(l){s?s(l):console.error(l),r.manager.itemError(e),r.manager.itemEnd(e)},a=new Yt(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{r.parse(l,i,function(h){t(h),r.manager.itemEnd(e)},c)}catch(h){c(h)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,s){let r;const i={},c={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Ut(new Uint8Array(e.slice(0,4)))===gr){try{i[w.KHR_BINARY_GLTF]=new zi(e)}catch(h){s&&s(h);return}r=JSON.parse(i[w.KHR_BINARY_GLTF].content)}else r=JSON.parse(Ut(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const a=new so(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});a.fileLoader.setRequestHeader(this.requestHeader);for(let l=0;l<this.pluginCallbacks.length;l++){const h=this.pluginCallbacks[l](a);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[h.name]=h,i[h.name]=!0}if(r.extensionsUsed)for(let l=0;l<r.extensionsUsed.length;++l){const h=r.extensionsUsed[l],u=r.extensionsRequired||[];switch(h){case w.KHR_MATERIALS_UNLIT:i[h]=new _i;break;case w.KHR_DRACO_MESH_COMPRESSION:i[h]=new Ki(r,this.dracoLoader);break;case w.KHR_TEXTURE_TRANSFORM:i[h]=new Xi;break;case w.KHR_MESH_QUANTIZATION:i[h]=new Wi;break;default:u.indexOf(h)>=0&&c[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}a.setExtensions(i),a.setPlugins(c),a.parse(n,s)}parseAsync(e,t){const n=this;return new Promise(function(s,r){n.parse(e,t,s,r)})}};function Si(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const w={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let bi=class{constructor(e){this.parser=e,this.name=w.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let s=t.cache.get(n);if(s)return s;const r=t.json,a=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let l;const h=new V(16777215);a.color!==void 0&&h.setRGB(a.color[0],a.color[1],a.color[2],pe);const u=a.range!==void 0?a.range:0;switch(a.type){case"directional":l=new Qt(h),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Ss(h),l.distance=u;break;case"spot":l=new Rs(h),l.distance=u,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,l.angle=a.spot.outerConeAngle,l.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return l.position.set(0,0,0),l.decay=2,fe(l,a),a.intensity!==void 0&&(l.intensity=a.intensity),l.name=t.createUniqueName(a.name||"light_"+e),s=Promise.resolve(l),t.cache.add(n,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],c=(r.extensions&&r.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(a){return n._getNodeRef(t.cache,c,a)})}},_i=class{constructor(){this.name=w.KHR_MATERIALS_UNLIT}getMaterialType(){return re}extendParams(e,t,n){const s=[];e.color=new V(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const i=r.baseColorFactor;e.color.setRGB(i[0],i[1],i[2],pe),e.opacity=i[3]}r.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",r.baseColorTexture,ke))}return Promise.all(s)}},Mi=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}},Ci=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];if(i.clearcoatFactor!==void 0&&(t.clearcoat=i.clearcoatFactor),i.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",i.clearcoatTexture)),i.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=i.clearcoatRoughnessFactor),i.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),i.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",i.clearcoatNormalTexture)),i.clearcoatNormalTexture.scale!==void 0)){const c=i.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new j(c,c)}return Promise.all(r)}},Li=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}},Ii=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return i.iridescenceFactor!==void 0&&(t.iridescence=i.iridescenceFactor),i.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),i.iridescenceIor!==void 0&&(t.iridescenceIOR=i.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),i.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),i.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),i.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(r)}},Ni=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new V(0,0,0),t.sheenRoughness=0,t.sheen=1;const i=s.extensions[this.name];if(i.sheenColorFactor!==void 0){const c=i.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],pe)}return i.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=i.sheenRoughnessFactor),i.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",i.sheenColorTexture,ke)),i.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(r)}},Pi=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return i.transmissionFactor!==void 0&&(t.transmission=i.transmissionFactor),i.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(r)}},Oi=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];t.thickness=i.thicknessFactor!==void 0?i.thicknessFactor:0,i.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",i.thicknessTexture)),t.attenuationDistance=i.attenuationDistance||1/0;const c=i.attenuationColor||[1,1,1];return t.attenuationColor=new V().setRGB(c[0],c[1],c[2],pe),Promise.all(r)}},Di=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}},Fi=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];t.specularIntensity=i.specularFactor!==void 0?i.specularFactor:1,i.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",i.specularTexture));const c=i.specularColorFactor||[1,1,1];return t.specularColor=new V().setRGB(c[0],c[1],c[2],pe),i.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",i.specularColorTexture,ke)),Promise.all(r)}},ki=class{constructor(e){this.parser=e,this.name=w.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return t.bumpScale=i.bumpFactor!==void 0?i.bumpFactor:1,i.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(r)}},Bi=class{constructor(e){this.parser=e,this.name=w.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return i.anisotropyStrength!==void 0&&(t.anisotropy=i.anisotropyStrength),i.anisotropyRotation!==void 0&&(t.anisotropyRotation=i.anisotropyRotation),i.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(r)}},Hi=class{constructor(e){this.parser=e,this.name=w.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,s=n.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,i)}},Gi=class{constructor(e){this.parser=e,this.name=w.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const i=r.extensions[t],c=s.images[i.source];let a=n.textureLoader;if(c.uri){const l=n.options.manager.getHandler(c.uri);l!==null&&(a=l)}return this.detectSupport().then(function(l){if(l)return n.loadTextureImage(e,i.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},Ui=class{constructor(e){this.parser=e,this.name=w.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const i=r.extensions[t],c=s.images[i.source];let a=n.textureLoader;if(c.uri){const l=n.options.manager.getHandler(c.uri);l!==null&&(a=l)}return this.detectSupport().then(function(l){if(l)return n.loadTextureImage(e,i.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},ji=class{constructor(e){this.name=w.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const s=n.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(c){const a=s.byteOffset||0,l=s.byteLength||0,h=s.count,u=s.byteStride,f=new Uint8Array(c,a,l);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(h,u,f,s.mode,s.filter).then(function(d){return d.buffer}):i.ready.then(function(){const d=new ArrayBuffer(h*u);return i.decodeGltfBuffer(new Uint8Array(d),h,u,f,s.mode,s.filter),d})})}else return null}},Vi=class{constructor(e){this.name=w.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const l of s.primitives)if(l.mode!==Q.TRIANGLES&&l.mode!==Q.TRIANGLE_STRIP&&l.mode!==Q.TRIANGLE_FAN&&l.mode!==void 0)return null;const i=n.extensions[this.name].attributes,c=[],a={};for(const l in i)c.push(this.parser.getDependency("accessor",i[l]).then(h=>(a[l]=h,a[l])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(l=>{const h=l.pop(),u=h.isGroup?h.children:[h],f=l[0].count,d=[];for(const p of u){const g=new Se,m=new ee,v=new Zt,T=new ee(1,1,1),E=new bs(p.geometry,p.material,f);for(let x=0;x<f;x++)a.TRANSLATION&&m.fromBufferAttribute(a.TRANSLATION,x),a.ROTATION&&v.fromBufferAttribute(a.ROTATION,x),a.SCALE&&T.fromBufferAttribute(a.SCALE,x),E.setMatrixAt(x,g.compose(m,v,T));for(const x in a)if(x==="_COLOR_0"){const b=a[x];E.instanceColor=new _s(b.array,b.itemSize,b.normalized)}else x!=="TRANSLATION"&&x!=="ROTATION"&&x!=="SCALE"&&p.geometry.setAttribute(x,a[x]);Jt.prototype.copy.call(E,p),this.parser.assignFinalMaterial(E),d.push(E)}return h.isGroup?(h.clear(),h.add(...d),h):d[0]}))}};const gr="glTF",at=12,rs={JSON:1313821514,BIN:5130562};let zi=class{constructor(e){this.name=w.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,at);if(this.header={magic:Ut(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==gr)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-at,s=new DataView(e,at);let r=0;for(;r<n;){const i=s.getUint32(r,!0);r+=4;const c=s.getUint32(r,!0);if(r+=4,c===rs.JSON){const a=new Uint8Array(e,at+r,i);this.content=Ut(a)}else if(c===rs.BIN){const a=at+r;this.body=e.slice(a,a+i)}r+=i}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},Ki=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=w.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,c={},a={},l={};for(const h in i){const u=Mn[h]||h.toLowerCase();c[u]=i[h]}for(const h in e.attributes){const u=Mn[h]||h.toLowerCase();if(i[h]!==void 0){const f=n.accessors[e.attributes[h]],d=Ye[f.componentType];l[u]=d.name,a[u]=f.normalized===!0}}return t.getDependency("bufferView",r).then(function(h){return new Promise(function(u,f){s.decodeDracoFile(h,function(d){for(const p in d.attributes){const g=d.attributes[p],m=a[p];m!==void 0&&(g.normalized=m)}u(d)},c,l,pe,f)})})}},Xi=class{constructor(){this.name=w.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},Wi=class{constructor(){this.name=w.KHR_MESH_QUANTIZATION}},vr=class extends qs{constructor(e,t,n,s){super(e,t,n,s)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let i=0;i!==s;i++)t[i]=n[r+i];return t}interpolate_(e,t,n,s){const r=this.resultBuffer,i=this.sampleValues,c=this.valueSize,a=c*2,l=c*3,h=s-t,u=(n-t)/h,f=u*u,d=f*u,p=e*l,g=p-l,m=-2*d+3*f,v=d-f,T=1-m,E=v-f+u;for(let x=0;x!==c;x++){const b=i[g+x+c],L=i[g+x+a]*h,A=i[p+x+c],O=i[p+x]*h;r[x]=T*b+E*L+m*A+v*O}return r}};const qi=new Zt;let $i=class extends vr{interpolate_(e,t,n,s){const r=super.interpolate_(e,t,n,s);return qi.fromArray(r).normalize().toArray(r),r}};const Q={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ye={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},is={9728:dt,9729:W,9984:Ns,9985:Is,9986:Ls,9987:en},os={33071:et,33648:Ps,10497:be},fn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...yi>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ge={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Yi={CUBICSPLINE:void 0,LINEAR:sn,STEP:Xs},dn={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Qi(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new tn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Hn})),o.DefaultMaterial}function Le(o,e,t){for(const n in t.extensions)o[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function fe(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Zi(o,e,t){let n=!1,s=!1,r=!1;for(let l=0,h=e.length;l<h;l++){const u=e[l];if(u.POSITION!==void 0&&(n=!0),u.NORMAL!==void 0&&(s=!0),u.COLOR_0!==void 0&&(r=!0),n&&s&&r)break}if(!n&&!s&&!r)return Promise.resolve(o);const i=[],c=[],a=[];for(let l=0,h=e.length;l<h;l++){const u=e[l];if(n){const f=u.POSITION!==void 0?t.getDependency("accessor",u.POSITION):o.attributes.position;i.push(f)}if(s){const f=u.NORMAL!==void 0?t.getDependency("accessor",u.NORMAL):o.attributes.normal;c.push(f)}if(r){const f=u.COLOR_0!==void 0?t.getDependency("accessor",u.COLOR_0):o.attributes.color;a.push(f)}}return Promise.all([Promise.all(i),Promise.all(c),Promise.all(a)]).then(function(l){const h=l[0],u=l[1],f=l[2];return n&&(o.morphAttributes.position=h),s&&(o.morphAttributes.normal=u),r&&(o.morphAttributes.color=f),o.morphTargetsRelative=!0,o})}function Ji(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let n=0,s=t.length;n<s;n++)o.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function eo(o){let e;const t=o.extensions&&o.extensions[w.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+pn(t.attributes):e=o.indices+":"+pn(o.attributes)+":"+o.mode,o.targets!==void 0)for(let n=0,s=o.targets.length;n<s;n++)e+=":"+pn(o.targets[n]);return e}function pn(o){let e="";const t=Object.keys(o).sort();for(let n=0,s=t.length;n<s;n++)e+=t[n]+":"+o[t[n]]+";";return e}function Cn(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function to(o){return o.search(/\.jpe?g($|\?)/i)>0||o.search(/^data\:image\/jpeg/)===0?"image/jpeg":o.search(/\.webp($|\?)/i)>0||o.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const no=new Se;let so=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Si,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||s&&r<98?this.textureLoader=new Bn(this.options.manager):this.textureLoader=new Ms(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Yt(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(i){return i._markDefs&&i._markDefs()}),Promise.all(this._invokeAll(function(i){return i.beforeRoot&&i.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(i){const c={scene:i[0][s.scene||0],scenes:i[0],animations:i[1],cameras:i[2],asset:s.asset,parser:n,userData:{}};return Le(r,c,s),fe(c,s),Promise.all(n._invokeAll(function(a){return a.afterRoot&&a.afterRoot(c)})).then(function(){for(const a of c.scenes)a.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let s=0,r=t.length;s<r;s++){const i=t[s].joints;for(let c=0,a=i.length;c<a;c++)e[i[c]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const i=e[s];i.mesh!==void 0&&(this._addNodeRef(this.meshCache,i.mesh),i.skin!==void 0&&(n[i.mesh].isSkinnedMesh=!0)),i.camera!==void 0&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const s=n.clone(),r=(i,c)=>{const a=this.associations.get(i);a!=null&&this.associations.set(c,a);for(const[l,h]of i.children.entries())r(h,c.children[l])};return r(n,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const s=e(t[n]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let s=0;s<t.length;s++){const r=e(t[s]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let s=this.cache.get(n);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(n,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(r,i){return n.getDependency(e,i)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[w.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,i){n.load(le.resolveURL(t.uri,s.path),r,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+s)})}loadAccessor(e){const t=this,n=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const i=fn[s.type],c=Ye[s.componentType],a=s.normalized===!0,l=new c(s.count*i);return Promise.resolve(new we(l,i,a))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(i){const c=i[0],a=fn[s.type],l=Ye[s.componentType],h=l.BYTES_PER_ELEMENT,u=h*a,f=s.byteOffset||0,d=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0,p=s.normalized===!0;let g,m;if(d&&d!==u){const v=Math.floor(f/d),T="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+v+":"+s.count;let E=t.cache.get(T);E||(g=new l(c,v*d,s.count*d/h),E=new Cs(g,d/h),t.cache.add(T,E)),m=new Ws(E,a,f%d/h,p)}else c===null?g=new l(s.count*a):g=new l(c,f,s.count*a),m=new we(g,a,p);if(s.sparse!==void 0){const v=fn.SCALAR,T=Ye[s.sparse.indices.componentType],E=s.sparse.indices.byteOffset||0,x=s.sparse.values.byteOffset||0,b=new T(i[1],E,s.sparse.count*v),L=new l(i[2],x,s.sparse.count*a);c!==null&&(m=new we(m.array.slice(),m.itemSize,m.normalized));for(let A=0,O=b.length;A<O;A++){const I=b[A];if(m.setX(I,L[A*a]),a>=2&&m.setY(I,L[A*a+1]),a>=3&&m.setZ(I,L[A*a+2]),a>=4&&m.setW(I,L[A*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,i=t.images[r];let c=this.textureLoader;if(i.uri){const a=n.manager.getHandler(i.uri);a!==null&&(c=a)}return this.loadTextureImage(e,r,c)}loadTextureImage(e,t,n){const s=this,r=this.json,i=r.textures[e],c=r.images[t],a=(c.uri||c.bufferView)+":"+i.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(t,n).then(function(h){h.flipY=!1,h.name=i.name||c.name||"",h.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(h.name=c.uri);const f=(r.samplers||{})[i.sampler]||{};return h.magFilter=is[f.magFilter]||W,h.minFilter=is[f.minFilter]||en,h.wrapS=os[f.wrapS]||be,h.wrapT=os[f.wrapT]||be,s.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[a]=l,l}loadImageSource(e,t){const n=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const i=s.images[e],c=self.URL||self.webkitURL;let a=i.uri||"",l=!1;if(i.bufferView!==void 0)a=n.getDependency("bufferView",i.bufferView).then(function(u){l=!0;const f=new Blob([u],{type:i.mimeType});return a=c.createObjectURL(f),a});else if(i.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(a).then(function(u){return new Promise(function(f,d){let p=f;t.isImageBitmapLoader===!0&&(p=function(g){const m=new Ge(g);m.needsUpdate=!0,f(m)}),t.load(le.resolveURL(u,r.path),p,void 0,d)})}).then(function(u){return l===!0&&c.revokeObjectURL(a),fe(u,i),u.userData.mimeType=i.mimeType||to(i.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),u});return this.sourceCache[e]=h,h}assignTexture(e,t,n,s){const r=this;return this.getDependency("texture",n.index).then(function(i){if(!i)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(i=i.clone(),i.channel=n.texCoord),r.extensions[w.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[w.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const a=r.associations.get(i);i=r.extensions[w.KHR_TEXTURE_TRANSFORM].extendTexture(i,c),r.associations.set(i,a)}}return s!==void 0&&(typeof s=="number"&&(s=s===ss?ke:pe),"colorSpace"in i?i.colorSpace=s:i.encoding=s===ke?ss:wi),e[t]=i,i})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,i=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let a=this.cache.get(c);a||(a=new Os,Re.prototype.copy.call(a,n),a.color.copy(n.color),a.map=n.map,a.sizeAttenuation=!1,this.cache.add(c,a)),n=a}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let a=this.cache.get(c);a||(a=new Ds,Re.prototype.copy.call(a,n),a.color.copy(n.color),a.map=n.map,this.cache.add(c,a)),n=a}if(s||r||i){let c="ClonedMaterial:"+n.uuid+":";s&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),i&&(c+="flat-shading:");let a=this.cache.get(c);a||(a=n.clone(),r&&(a.vertexColors=!0),i&&(a.flatShading=!0),s&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(c,a),this.associations.set(a,this.associations.get(n))),n=a}e.material=n}getMaterialType(){return tn}loadMaterial(e){const t=this,n=this.json,s=this.extensions,r=n.materials[e];let i;const c={},a=r.extensions||{},l=[];if(a[w.KHR_MATERIALS_UNLIT]){const u=s[w.KHR_MATERIALS_UNLIT];i=u.getMaterialType(),l.push(u.extendParams(c,r,t))}else{const u=r.pbrMetallicRoughness||{};if(c.color=new V(1,1,1),c.opacity=1,Array.isArray(u.baseColorFactor)){const f=u.baseColorFactor;c.color.setRGB(f[0],f[1],f[2],pe),c.opacity=f[3]}u.baseColorTexture!==void 0&&l.push(t.assignTexture(c,"map",u.baseColorTexture,ke)),c.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,c.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(l.push(t.assignTexture(c,"metalnessMap",u.metallicRoughnessTexture)),l.push(t.assignTexture(c,"roughnessMap",u.metallicRoughnessTexture))),i=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,c)})))}r.doubleSided===!0&&(c.side=Xe);const h=r.alphaMode||dn.OPAQUE;if(h===dn.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,h===dn.MASK&&(c.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&i!==re&&(l.push(t.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new j(1,1),r.normalTexture.scale!==void 0)){const u=r.normalTexture.scale;c.normalScale.set(u,u)}if(r.occlusionTexture!==void 0&&i!==re&&(l.push(t.assignTexture(c,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&i!==re){const u=r.emissiveFactor;c.emissive=new V().setRGB(u[0],u[1],u[2],pe)}return r.emissiveTexture!==void 0&&i!==re&&l.push(t.assignTexture(c,"emissiveMap",r.emissiveTexture,ke)),Promise.all(l).then(function(){const u=new i(c);return r.name&&(u.name=r.name),fe(u,r),t.associations.set(u,{materials:e}),r.extensions&&Le(s,u,r),u})}createUniqueName(e){const t=Fs.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,s=this.primitiveCache;function r(c){return n[w.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(a){return as(a,c,t)})}const i=[];for(let c=0,a=e.length;c<a;c++){const l=e[c],h=eo(l),u=s[h];if(u)i.push(u.promise);else{let f;l.extensions&&l.extensions[w.KHR_DRACO_MESH_COMPRESSION]?f=r(l):f=as(new nn,l,t),s[h]={primitive:l,promise:f},i.push(f)}}return Promise.all(i)}loadMesh(e){const t=this,n=this.json,s=this.extensions,r=n.meshes[e],i=r.primitives,c=[];for(let a=0,l=i.length;a<l;a++){const h=i[a].material===void 0?Qi(this.cache):this.getDependency("material",i[a].material);c.push(h)}return c.push(t.loadGeometries(i)),Promise.all(c).then(function(a){const l=a.slice(0,a.length-1),h=a[a.length-1],u=[];for(let d=0,p=h.length;d<p;d++){const g=h[d],m=i[d];let v;const T=l[d];if(m.mode===Q.TRIANGLES||m.mode===Q.TRIANGLE_STRIP||m.mode===Q.TRIANGLE_FAN||m.mode===void 0)v=r.isSkinnedMesh===!0?new ks(g,T):new yt(g,T),v.isSkinnedMesh===!0&&v.normalizeSkinWeights(),m.mode===Q.TRIANGLE_STRIP?v.geometry=ns(v.geometry,$t):m.mode===Q.TRIANGLE_FAN&&(v.geometry=ns(v.geometry,Je));else if(m.mode===Q.LINES)v=new Bs(g,T);else if(m.mode===Q.LINE_STRIP)v=new Hs(g,T);else if(m.mode===Q.LINE_LOOP)v=new Gs(g,T);else if(m.mode===Q.POINTS)v=new Us(g,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(v.geometry.morphAttributes).length>0&&Ji(v,r),v.name=t.createUniqueName(r.name||"mesh_"+e),fe(v,r),m.extensions&&Le(s,v,m),t.assignFinalMaterial(v),u.push(v)}for(let d=0,p=u.length;d<p;d++)t.associations.set(u[d],{meshes:e,primitives:d});if(u.length===1)return r.extensions&&Le(s,u[0],r),u[0];const f=new qe;r.extensions&&Le(s,f,r),t.associations.set(f,{meshes:e});for(let d=0,p=u.length;d<p;d++)f.add(u[d]);return f})}loadCamera(e){let t;const n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new wt(js.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new Rt(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),fe(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let s=0,r=t.joints.length;s<r;s++)n.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(s){const r=s.pop(),i=s,c=[],a=[];for(let l=0,h=i.length;l<h;l++){const u=i[l];if(u){c.push(u);const f=new Se;r!==null&&f.fromArray(r.array,l*16),a.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Vs(c,a)})}loadAnimation(e){const t=this.json,n=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,i=[],c=[],a=[],l=[],h=[];for(let u=0,f=s.channels.length;u<f;u++){const d=s.channels[u],p=s.samplers[d.sampler],g=d.target,m=g.node,v=s.parameters!==void 0?s.parameters[p.input]:p.input,T=s.parameters!==void 0?s.parameters[p.output]:p.output;g.node!==void 0&&(i.push(this.getDependency("node",m)),c.push(this.getDependency("accessor",v)),a.push(this.getDependency("accessor",T)),l.push(p),h.push(g))}return Promise.all([Promise.all(i),Promise.all(c),Promise.all(a),Promise.all(l),Promise.all(h)]).then(function(u){const f=u[0],d=u[1],p=u[2],g=u[3],m=u[4],v=[];for(let T=0,E=f.length;T<E;T++){const x=f[T],b=d[T],L=p[T],A=g[T],O=m[T];if(x===void 0)continue;x.updateMatrix&&x.updateMatrix();const I=n._createAnimationTracks(x,b,L,A,O);if(I)for(let y=0;y<I.length;y++)v.push(I[y])}return new zs(r,void 0,v)})}createNodeMesh(e){const t=this.json,n=this,s=t.nodes[e];return s.mesh===void 0?null:n.getDependency("mesh",s.mesh).then(function(r){const i=n._getNodeRef(n.meshCache,s.mesh,r);return s.weights!==void 0&&i.traverse(function(c){if(c.isMesh)for(let a=0,l=s.weights.length;a<l;a++)c.morphTargetInfluences[a]=s.weights[a]}),i})}loadNode(e){const t=this.json,n=this,s=t.nodes[e],r=n._loadNodeShallow(e),i=[],c=s.children||[];for(let l=0,h=c.length;l<h;l++)i.push(n.getDependency("node",c[l]));const a=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([r,Promise.all(i),a]).then(function(l){const h=l[0],u=l[1],f=l[2];f!==null&&h.traverse(function(d){d.isSkinnedMesh&&d.bind(f,no)});for(let d=0,p=u.length;d<p;d++)h.add(u[d]);return h})}_loadNodeShallow(e){const t=this.json,n=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],i=r.name?s.createUniqueName(r.name):"",c=[],a=s._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return a&&c.push(a),r.camera!==void 0&&c.push(s.getDependency("camera",r.camera).then(function(l){return s._getNodeRef(s.cameraCache,r.camera,l)})),s._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){c.push(l)}),this.nodeCache[e]=Promise.all(c).then(function(l){let h;if(r.isBone===!0?h=new Ks:l.length>1?h=new qe:l.length===1?h=l[0]:h=new Jt,h!==l[0])for(let u=0,f=l.length;u<f;u++)h.add(l[u]);if(r.name&&(h.userData.name=r.name,h.name=i),fe(h,r),r.extensions&&Le(n,h,r),r.matrix!==void 0){const u=new Se;u.fromArray(r.matrix),h.applyMatrix4(u)}else r.translation!==void 0&&h.position.fromArray(r.translation),r.rotation!==void 0&&h.quaternion.fromArray(r.rotation),r.scale!==void 0&&h.scale.fromArray(r.scale);return s.associations.has(h)||s.associations.set(h,{}),s.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],s=this,r=new qe;n.name&&(r.name=s.createUniqueName(n.name)),fe(r,n),n.extensions&&Le(t,r,n);const i=n.nodes||[],c=[];for(let a=0,l=i.length;a<l;a++)c.push(s.getDependency("node",i[a]));return Promise.all(c).then(function(a){for(let h=0,u=a.length;h<u;h++)r.add(a[h]);const l=h=>{const u=new Map;for(const[f,d]of s.associations)(f instanceof Re||f instanceof Ge)&&u.set(f,d);return h.traverse(f=>{const d=s.associations.get(f);d!=null&&u.set(f,d)}),u};return s.associations=l(r),r})}_createAnimationTracks(e,t,n,s,r){const i=[],c=e.name?e.name:e.uuid,a=[];ge[r.path]===ge.weights?e.traverse(function(f){f.morphTargetInfluences&&a.push(f.name?f.name:f.uuid)}):a.push(c);let l;switch(ge[r.path]){case ge.weights:l=Dt;break;case ge.rotation:l=Ft;break;case ge.position:case ge.scale:l=Ot;break;default:n.itemSize===1?l=Dt:l=Ot;break}const h=s.interpolation!==void 0?Yi[s.interpolation]:sn,u=this._getArrayFromAccessor(n);for(let f=0,d=a.length;f<d;f++){const p=new l(a[f]+"."+ge[r.path],t.array,u,h);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),i.push(p)}return i}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=Cn(t.constructor),s=new Float32Array(t.length);for(let r=0,i=t.length;r<i;r++)s[r]=t[r]*n;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const s=this instanceof Ft?$i:vr;return new s(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function ro(o,e,t){const n=e.attributes,s=new $s;if(n.POSITION!==void 0){const c=t.json.accessors[n.POSITION],a=c.min,l=c.max;if(a!==void 0&&l!==void 0){if(s.set(new ee(a[0],a[1],a[2]),new ee(l[0],l[1],l[2])),c.normalized){const h=Cn(Ye[c.componentType]);s.min.multiplyScalar(h),s.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const c=new ee,a=new ee;for(let l=0,h=r.length;l<h;l++){const u=r[l];if(u.POSITION!==void 0){const f=t.json.accessors[u.POSITION],d=f.min,p=f.max;if(d!==void 0&&p!==void 0){if(a.setX(Math.max(Math.abs(d[0]),Math.abs(p[0]))),a.setY(Math.max(Math.abs(d[1]),Math.abs(p[1]))),a.setZ(Math.max(Math.abs(d[2]),Math.abs(p[2]))),f.normalized){const g=Cn(Ye[f.componentType]);a.multiplyScalar(g)}c.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(c)}o.boundingBox=s;const i=new Ys;s.getCenter(i.center),i.radius=s.min.distanceTo(s.max)/2,o.boundingSphere=i}function as(o,e,t){const n=e.attributes,s=[];function r(i,c){return t.getDependency("accessor",i).then(function(a){o.setAttribute(c,a)})}for(const i in n){const c=Mn[i]||i.toLowerCase();c in o.attributes||s.push(r(n[i],c))}if(e.indices!==void 0&&!o.index){const i=t.getDependency("accessor",e.indices).then(function(c){o.setIndex(c)});s.push(i)}return fe(o,e),ro(o,e,t),Promise.all(s).then(function(){return e.targets!==void 0?Zi(o,e.targets,t):o})}var mn=1/1e3,io=1e3,oo=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(o){typeof document<"u"&&document.hidden!==void 0&&(o?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=o)}get delta(){return this._delta*mn}get fixedDelta(){return this._fixedDelta*mn}set fixedDelta(o){this._fixedDelta=o*io}get elapsed(){return this._elapsed*mn}update(o){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(o!==void 0?o:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(o){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},ao=(()=>{const o=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new nn;return t.setAttribute("position",new we(o,3)),t.setAttribute("uv",new we(e,2)),t})(),Me=class Ln{static get fullscreenGeometry(){return ao}constructor(e="Pass",t=new pt,n=new Rt){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new yt(Ln.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new pt),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=rn){}render(e,t,n,s,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof St||t instanceof Re||t instanceof Ge||t instanceof Ln)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},co=class extends Me{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,s,r){const i=e.state.buffers.stencil;i.setLocked(!1),i.setTest(!1)}},lo=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,uo="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",ho=class extends tt{constructor(){super({name:"CopyMaterial",defines:{COLOR_SPACE_CONVERSION:"1",DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new B(null),depthBuffer:new B(null),channelWeights:new B(null),opacity:new B(1)},blending:Gn,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:lo,vertexShader:uo}),this.depthFunc=Lr}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(o){const e=o!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=o}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(o){const e=o!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=o}set depthPacking(o){this.defines.DEPTH_PACKING=o.toFixed(0),this.needsUpdate=!0}get colorSpaceConversion(){return this.defines.COLOR_SPACE_CONVERSION!==void 0}set colorSpaceConversion(o){this.colorSpaceConversion!==o&&(o?this.defines.COLOR_SPACE_CONVERSION=!0:delete this.defines.COLOR_SPACE_CONVERSION,this.needsUpdate=!0)}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(o){o!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=o):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(o){this.uniforms.inputBuffer.value=o}getOpacity(o){return this.uniforms.opacity.value}setOpacity(o){this.uniforms.opacity.value=o}},fo=class extends Me{constructor(o,e=!0){super("CopyPass"),this.fullscreenMaterial=new ho,this.needsSwap=!1,this.renderTarget=o,o===void 0&&(this.renderTarget=new St(1,1,{minFilter:W,magFilter:W,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(o){this.autoResize=o}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(o){this.autoResize=o}render(o,e,t,n,s){this.fullscreenMaterial.inputBuffer=e.texture,o.setRenderTarget(this.renderToScreen?null:this.renderTarget),o.render(this.scene,this.camera)}setSize(o,e){this.autoResize&&this.renderTarget.setSize(o,e)}initialize(o,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==kt?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":o!==null&&o.outputColorSpace===K&&(this.renderTarget.texture.colorSpace=K))}},cs=new V,Tr=class extends Me{constructor(o=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=o,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(o,e,t){this.color=o,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(o){this.overrideClearColor=o}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(o){this.overrideClearAlpha=o}render(o,e,t,n,s){const r=this.overrideClearColor,i=this.overrideClearAlpha,c=o.getClearAlpha(),a=r!==null,l=i>=0;a?(o.getClearColor(cs),o.setClearColor(r,l?i:c)):l&&o.setClearAlpha(i),o.setRenderTarget(this.renderToScreen?null:e),o.clear(this.color,this.depth,this.stencil),a?o.setClearColor(cs,c):l&&o.setClearAlpha(c)}},po=class extends Me{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Tr(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,s,r){const i=e.getContext(),c=e.state.buffers,a=this.scene,l=this.camera,h=this.clearPass,u=this.inverted?0:1,f=1-u;c.color.setMask(!1),c.depth.setMask(!1),c.color.setLocked(!0),c.depth.setLocked(!0),c.stencil.setTest(!0),c.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),c.stencil.setFunc(i.ALWAYS,u,4294967295),c.stencil.setClear(f),c.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?h.render(e,null):(h.render(e,t),h.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(a,l)):(e.setRenderTarget(t),e.render(a,l),e.setRenderTarget(n),e.render(a,l)),c.color.setLocked(!1),c.depth.setLocked(!1),c.stencil.setLocked(!1),c.stencil.setFunc(i.EQUAL,1,4294967295),c.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),c.stencil.setLocked(!0)}},mo=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:s=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,n,r,s),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new fo,this.depthTexture=null,this.passes=[],this.timer=new oo,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new j),n=e.getContext().getContextAttributes().alpha,s=this.inputBuffer.texture.type;s===kt&&e.outputColorSpace===K&&(this.inputBuffer.texture.colorSpace=K,this.outputBuffer.texture.colorSpace=K,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const r of this.passes)r.initialize(e,n,s)}}replaceRenderer(e,t=!0){const n=this.renderer,s=n.domElement.parentNode;return this.setRenderer(e),t&&s!==null&&(s.removeChild(n.domElement),s.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new br;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=_r,e.type=Mr):e.type=Cr,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,s){const r=this.renderer,i=r===null?new j:r.getDrawingBufferSize(new j),c={minFilter:W,magFilter:W,stencilBuffer:t,depthBuffer:e,type:n},a=new St(i.width,i.height,c);return s>0&&(a.samples=s),n===kt&&r!==null&&r.outputColorSpace===K&&(a.texture.colorSpace=K),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const n=this.passes,s=this.renderer,r=s.getDrawingBufferSize(new j),i=s.getContext().getContextAttributes().alpha,c=this.inputBuffer.texture.type;if(e.setRenderer(s),e.setSize(r.width,r.height),e.initialize(s,i,c),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const a=this.createDepthTexture();for(e of n)e.setDepthTexture(a)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(n!==-1&&t.splice(n,1).length>0){if(this.depthTexture!==null){const i=(a,l)=>a||l.needsDepthTexture;t.reduce(i,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let s=this.inputBuffer,r=this.outputBuffer,i=!1,c,a,l;e===void 0&&(this.timer.update(),e=this.timer.getDelta());for(const h of this.passes)h.enabled&&(h.render(t,s,r,e,i),h.needsSwap&&(i&&(n.renderToScreen=h.renderToScreen,c=t.getContext(),a=t.state.buffers.stencil,a.setFunc(c.NOTEQUAL,1,4294967295),n.render(t,s,r,e,i),a.setFunc(c.EQUAL,1,4294967295)),l=s,s=r,r=l),h instanceof po?i=!0:h instanceof co&&(i=!1))}setSize(e,t,n){const s=this.renderer,r=s.getSize(new j);(e===void 0||t===void 0)&&(e=r.width,t=r.height),(r.width!==e||r.height!==t)&&s.setSize(e,t,n);const i=s.getDrawingBufferSize(new j);this.inputBuffer.setSize(i.width,i.height),this.outputBuffer.setSize(i.width,i.height);for(const c of this.passes)c.setSize(i.width,i.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Me.fullscreenGeometry.dispose()}},Be={NONE:0,DEPTH:1,CONVOLUTION:2},M={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},go=class{constructor(){this.shaderParts=new Map([[M.FRAGMENT_HEAD,null],[M.FRAGMENT_MAIN_UV,null],[M.FRAGMENT_MAIN_IMAGE,null],[M.VERTEX_HEAD,null],[M.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Be.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=te}},gn=!1,ls=class{constructor(o=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(o),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case Xe:t=this.materialsFlatShadedDoubleSide;break;case Mt:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case Xe:t=this.materialsDoubleSide;break;case Mt:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(o){if(!(o instanceof tt))return o.clone();const e=o.uniforms,t=new Map;for(const s in e){const r=e[s].value;r.isRenderTargetTexture&&(e[s].value=null,t.set(s,r))}const n=o.clone();for(const s of t)e[s[0]].value=s[1],n.uniforms[s[0]].value=s[1];return n}setMaterial(o){if(this.disposeMaterials(),this.material=o,o!==null){const e=this.materials=[this.cloneMaterial(o),this.cloneMaterial(o),this.cloneMaterial(o)];for(const t of e)t.uniforms=Object.assign({},o.uniforms),t.side=Hn;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},o.uniforms),n.side=Mt,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},o.uniforms),n.side=Xe,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},o.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},o.uniforms),n.flatShading=!0,n.side=Mt,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},o.uniforms),n.flatShading=!0,n.side=Xe,n})}}render(o,e,t){const n=o.shadowMap.enabled;if(o.shadowMap.enabled=!1,gn){const s=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),o.render(e,t);for(const r of s)r[0].material=r[1];this.meshCount!==s.size&&s.clear()}else{const s=e.overrideMaterial;e.overrideMaterial=this.material,o.render(e,t),e.overrideMaterial=s}o.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const o=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of o)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return gn}static set workaroundEnabled(o){gn=o}},S={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},vo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",To="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,src.a*opacity);}",xo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=(dst.rgb+src.rgb)*0.5;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Eo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.xy,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Ao="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/max(b,1e-9))),vec3(1.0),step(1.0,a));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",yo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",wo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Ro="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=abs(dst.rgb-src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",So="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb/max(src.rgb,1e-9);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",bo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-2.0*dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",_o="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb,1.0);vec3 b=min(src.rgb,1.0);vec3 c=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Mo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=step(1.0,dst.rgb+src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Co="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.x,a.yz));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Lo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Io="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=src.rgb*max(1.0-dst.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",No="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Po="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Oo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb+src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Do="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(2.0*src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Fo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.xy,b.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",ko="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Bo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-abs(1.0-dst.rgb-src.rgb),0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Ho="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,opacity);}",Go="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=2.0*src.rgb*dst.rgb;vec3 b=1.0-2.0*(1.0-src.rgb)*(1.0-dst.rgb);vec3 c=mix(a,b,step(0.5,dst.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Uo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 c=mix(mix(src2,dst.rgb,step(0.5*dst.rgb,src.rgb)),max(src2-1.0,vec3(0.0)),step(dst.rgb,src2-1.0));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",jo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb*dst.rgb/max(1.0-src.rgb,1e-9),1.0);vec3 c=mix(a,src.rgb,step(1.0,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Vo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.x,b.y,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",zo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-min(dst.rgb*src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Ko="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 d=dst.rgb+(src2-1.0);vec3 w=step(0.5,src.rgb);vec3 a=dst.rgb-(1.0-src2)*dst.rgb*(1.0-dst.rgb);vec3 b=mix(d*(sqrt(dst.rgb)-dst.rgb),d*dst.rgb*((16.0*dst.rgb-12.0)*dst.rgb+3.0),w*(1.0-step(0.25,dst.rgb)));vec3 c=mix(a,b,w);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Xo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return src;}",Wo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",qo="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=mix(max(1.0-min((1.0-dst.rgb)/(2.0*src.rgb),1.0),0.0),min(dst.rgb/(2.0*(1.0-src.rgb)),1.0),step(0.5,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",$o=new Map([[S.ADD,vo],[S.ALPHA,To],[S.AVERAGE,xo],[S.COLOR,Eo],[S.COLOR_BURN,Ao],[S.COLOR_DODGE,yo],[S.DARKEN,wo],[S.DIFFERENCE,Ro],[S.DIVIDE,So],[S.DST,null],[S.EXCLUSION,bo],[S.HARD_LIGHT,_o],[S.HARD_MIX,Mo],[S.HUE,Co],[S.INVERT,Lo],[S.INVERT_RGB,Io],[S.LIGHTEN,No],[S.LINEAR_BURN,Po],[S.LINEAR_DODGE,Oo],[S.LINEAR_LIGHT,Do],[S.LUMINOSITY,Fo],[S.MULTIPLY,ko],[S.NEGATION,Bo],[S.NORMAL,Ho],[S.OVERLAY,Go],[S.PIN_LIGHT,Uo],[S.REFLECT,jo],[S.SATURATION,Vo],[S.SCREEN,zo],[S.SOFT_LIGHT,Ko],[S.SRC,Xo],[S.SUBTRACT,Wo],[S.VIVID_LIGHT,qo]]),Yo=class extends Qs{constructor(o,e=1){super(),this._blendFunction=o,this.opacity=new B(e)}getOpacity(){return this.opacity.value}setOpacity(o){this.opacity.value=o}get blendFunction(){return this._blendFunction}set blendFunction(o){this._blendFunction=o,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(o){this.blendFunction=o}getShaderCode(){return $o.get(this.blendFunction)}},Qo=class extends Qs{constructor(o,e,{attributes:t=Be.NONE,blendFunction:n=S.NORMAL,defines:s=new Map,uniforms:r=new Map,extensions:i=null,vertexShader:c=null}={}){super(),this.name=o,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=c,this.defines=s,this.uniforms=r,this.extensions=i,this.blendMode=new Yo(n),this.blendMode.addEventListener("change",a=>this.setChanged()),this._inputColorSpace=te,this._outputColorSpace=Zs}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(o){this._inputColorSpace=o,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(o){this._outputColorSpace=o,this.setChanged()}set mainScene(o){}set mainCamera(o){}getName(){return this.name}setRenderer(o){this.renderer=o}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(o){this.attributes=o,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(o){this.fragmentShader=o,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(o){this.vertexShader=o,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(o,e=rn){}update(o,e,t){}setSize(o,e){}initialize(o,e,t){}dispose(){for(const o of Object.keys(this)){const e=this[o];(e instanceof St||e instanceof Re||e instanceof Ge||e instanceof Me)&&this[o].dispose()}}},Zo=class extends Me{constructor(e,t,n=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Tr,this.overrideMaterialManager=n===null?null:new ls(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new ls(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,s,r){const i=this.scene,c=this.camera,a=this.selection,l=c.layers.mask,h=i.background,u=e.shadowMap.autoUpdate,f=this.renderToScreen?null:t;a!==null&&c.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(i.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(f),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,i,c):e.render(i,c),c.layers.mask=l,i.background=h,e.shadowMap.autoUpdate=u}},Jo=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,ea="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",ta=class extends tt{constructor(o,e,t,n,s=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:As.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new B(null),depthBuffer:new B(null),resolution:new B(new j),texelSize:new B(new j),cameraNear:new B(.3),cameraFar:new B(1e3),aspect:new B(1),time:new B(0)},blending:Gn,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:s}),o&&this.setShaderParts(o),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.uniforms.inputBuffer.value=o}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(o){this.uniforms.depthBuffer.value=o}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(o){this.defines.DEPTH_PACKING=o.toFixed(0),this.needsUpdate=!0}setDepthBuffer(o,e=rn){this.depthBuffer=o,this.depthPacking=e}setShaderData(o){this.setShaderParts(o.shaderParts),this.setDefines(o.defines),this.setUniforms(o.uniforms),this.setExtensions(o.extensions)}setShaderParts(o){return this.fragmentShader=Jo.replace(M.FRAGMENT_HEAD,o.get(M.FRAGMENT_HEAD)||"").replace(M.FRAGMENT_MAIN_UV,o.get(M.FRAGMENT_MAIN_UV)||"").replace(M.FRAGMENT_MAIN_IMAGE,o.get(M.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=ea.replace(M.VERTEX_HEAD,o.get(M.VERTEX_HEAD)||"").replace(M.VERTEX_MAIN_SUPPORT,o.get(M.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(o){for(const e of o.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(o){for(const e of o.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(o){this.extensions={};for(const e of o)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(o){this.encodeOutput!==o&&(o?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(o){return this.encodeOutput}setOutputEncodingEnabled(o){this.encodeOutput=o}get time(){return this.uniforms.time.value}set time(o){this.uniforms.time.value=o}setDeltaTime(o){this.uniforms.time.value+=o}adoptCameraSettings(o){this.copyCameraSettings(o)}copyCameraSettings(o){o&&(this.uniforms.cameraNear.value=o.near,this.uniforms.cameraFar.value=o.far,o instanceof wt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(o,e){const t=this.uniforms;t.resolution.value.set(o,e),t.texelSize.value.set(1/o,1/e),t.aspect.value=o/e}static get Section(){return M}};function us(o,e,t){for(const n of e){const s="$1"+o+n.charAt(0).toUpperCase()+n.slice(1),r=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const i of t.entries())i[1]!==null&&t.set(i[0],i[1].replace(r,s))}}function na(o,e,t){let n=e.getFragmentShader(),s=e.getVertexShader();const r=n!==void 0&&/mainImage/.test(n),i=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(i&&(t.attributes&Be.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!i)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const c=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,a=t.shaderParts;let l=a.get(M.FRAGMENT_HEAD)||"",h=a.get(M.FRAGMENT_MAIN_UV)||"",u=a.get(M.FRAGMENT_MAIN_IMAGE)||"",f=a.get(M.VERTEX_HEAD)||"",d=a.get(M.VERTEX_MAIN_SUPPORT)||"";const p=new Set,g=new Set;if(i&&(h+=`	${o}MainUv(UV);
`,t.uvTransformation=!0),s!==null&&/mainSupport/.test(s)){const T=/mainSupport *\([\w\s]*?uv\s*?\)/.test(s);d+=`	${o}MainSupport(`,d+=T?`vUv);
`:`);
`;for(const E of s.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const x of E[1].split(/\s*,\s*/))t.varyings.add(x),p.add(x),g.add(x);for(const E of s.matchAll(c))g.add(E[1])}for(const T of n.matchAll(c))g.add(T[1]);for(const T of e.defines.keys())g.add(T.replace(/\([\w\s,]*\)/g,""));for(const T of e.uniforms.keys())g.add(T);g.delete("while"),g.delete("for"),g.delete("if"),e.uniforms.forEach((T,E)=>t.uniforms.set(o+E.charAt(0).toUpperCase()+E.slice(1),T)),e.defines.forEach((T,E)=>t.defines.set(o+E.charAt(0).toUpperCase()+E.slice(1),T));const m=new Map([["fragment",n],["vertex",s]]);us(o,g,t.defines),us(o,g,m),n=m.get("fragment"),s=m.get("vertex");const v=e.blendMode;if(t.blendModes.set(v.blendFunction,v),r){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(u+=e.inputColorSpace===K?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Zs?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const T=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;u+=`${o}MainImage(color0, UV, `,(t.attributes&Be.DEPTH)!==0&&T.test(n)&&(u+="depth, ",t.readDepth=!0),u+=`color1);
	`;const E=o+"BlendOpacity";t.uniforms.set(E,v.opacity),u+=`color0 = blend${v.blendFunction}(color0, color1, ${E});

	`,l+=`uniform float ${E};

`}if(l+=n+`
`,s!==null&&(f+=s+`
`),a.set(M.FRAGMENT_HEAD,l),a.set(M.FRAGMENT_MAIN_UV,h),a.set(M.FRAGMENT_MAIN_IMAGE,u),a.set(M.VERTEX_HEAD,f),a.set(M.VERTEX_MAIN_SUPPORT,d),e.extensions!==null)for(const T of e.extensions)t.extensions.add(T)}}var sa=class extends Me{constructor(o,...e){super("EffectPass"),this.fullscreenMaterial=new ta(null,null,null,o),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(o){for(const e of this.effects)e.mainScene=o}set mainCamera(o){this.fullscreenMaterial.copyCameraSettings(o);for(const e of this.effects)e.mainCamera=o}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(o){this.fullscreenMaterial.encodeOutput=o}get dithering(){return this.fullscreenMaterial.dithering}set dithering(o){const e=this.fullscreenMaterial;e.dithering=o,e.needsUpdate=!0}setEffects(o){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=o.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const o=new go;let e=0;for(const i of this.effects)if(i.blendMode.blendFunction===S.DST)o.attributes|=i.getAttributes()&Be.DEPTH;else{if((o.attributes&i.getAttributes()&Be.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${i.name})`);na("e"+e++,i,o)}let t=o.shaderParts.get(M.FRAGMENT_HEAD),n=o.shaderParts.get(M.FRAGMENT_MAIN_IMAGE),s=o.shaderParts.get(M.FRAGMENT_MAIN_UV);const r=/\bblend\b/g;for(const i of o.blendModes.values())t+=i.getShaderCode().replace(r,`blend${i.blendFunction}`)+`
`;(o.attributes&Be.DEPTH)!==0?(o.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,o.colorSpace===K&&(n+=`color0 = sRGBToLinear(color0);
	`),o.uvTransformation?(s=`vec2 transformedUv = vUv;
`+s,o.defines.set("UV","transformedUv")):o.defines.set("UV","vUv"),o.shaderParts.set(M.FRAGMENT_HEAD,t),o.shaderParts.set(M.FRAGMENT_MAIN_IMAGE,n),o.shaderParts.set(M.FRAGMENT_MAIN_UV,s);for(const[i,c]of o.shaderParts)c!==null&&o.shaderParts.set(i,c.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(o)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(o,e=rn){this.fullscreenMaterial.depthBuffer=o,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(o,e)}render(o,e,t,n,s){for(const r of this.effects)r.update(o,e,n);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,r.time+=n*this.timeScale,o.setRenderTarget(this.renderToScreen?null:t),o.render(this.scene,this.camera)}}setSize(o,e){this.fullscreenMaterial.setSize(o,e);for(const t of this.effects)t.setSize(o,e)}initialize(o,e,t){this.renderer=o;for(const n of this.effects)n.initialize(o,e,t);this.updateMaterial(),t!==void 0&&t!==kt&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const o of this.effects)o.removeEventListener("change",this.listener),o.dispose()}handleEvent(o){o.type==="change"&&this.recompile()}};const ra=`
uniform sampler2D uCharacters;
uniform float uCharactersCount;
uniform float uCellSize;
uniform bool uInvert;
uniform vec3 uColor;
uniform float uOpacity;

const vec2 SIZE = vec2(16.);

float random(vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}

vec3 greyscale(vec3 color, float strength) {
    float g = dot(color, vec3(0.299, 0.587, 0.114));
    return mix(color, vec3(g), strength);
}

vec3 greyscale(vec3 color) {
    return greyscale(color, 1.0);
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
    vec2 cell = resolution / uCellSize;
    vec2 grid = 1.0 / cell;
    vec2 pixelizedUV = grid * (0.5 + floor(uv / grid));
    vec4 pixelized = texture2D(inputBuffer, pixelizedUV);
    float greyscaled = greyscale(pixelized.rgb).r;

    if (uInvert) {
        greyscaled = 1.0 - greyscaled;
    }

    float characterIndex = floor((uCharactersCount - 1.0) * greyscaled);
    vec2 characterPosition = vec2(mod(characterIndex, SIZE.x), floor(characterIndex / SIZE.y));
    vec2 offset = vec2(characterPosition.x, -characterPosition.y) / SIZE;
    vec2 charUV = mod(uv * (cell / SIZE), 1.0 / SIZE) - vec2(0., 1.0 / SIZE) + offset;
    vec4 asciiCharacter = texture2D(uCharacters, charUV);

    // Add grain to background
    float grain = random(uv * 2.0);
    vec3 grainColor = mix(pixelized.rgb, vec3(grain), 0.08);

    asciiCharacter.rgb = uColor * asciiCharacter.r * uOpacity;
    asciiCharacter.rgb = mix(asciiCharacter.rgb, vec3(grain), 0.05 * uOpacity);
    asciiCharacter.a = pixelized.a * asciiCharacter.a;
    outputColor = asciiCharacter;
}
`;class ia extends Qo{constructor({characters:e=" .:,'-^=*+?!|0#%@",fontSize:t=10,cellSize:n=32,color:s="#ff1616ff",invert:r=!1,fontFamily:i="secondary"}={}){const c=new Map([["uCharacters",new B(new Ge)],["uCellSize",new B(n)],["uCharactersCount",new B(e.length)],["uColor",new B(new V(s))],["uInvert",new B(r)],["uOpacity",new B(1)]]);super("ASCIIEffect",ra,{uniforms:c});const a=this.uniforms.get("uCharacters");a&&(a.value=this.createCharactersTexture(e,t,i))}createCharactersTexture(e,t,n){const s=document.createElement("canvas"),r=1024,i=16,c=r/i;s.width=s.height=r;const a=new Js(s,void 0,be,be,dt,dt),l=s.getContext("2d");if(!l)throw new Error("Context not available");const h=()=>{l.clearRect(0,0,r,r),l.font=`${t}px "${n}", monospace`,l.textAlign="center",l.textBaseline="middle",l.fillStyle="#ff0000ff";for(let u=0;u<e.length;u++){const f=e[u],d=u%i,p=Math.floor(u/i);l.fillText(f,d*c+c/2,p*c+c/2)}a.needsUpdate=!0};return document.fonts.load(`${t}px "${n}"`).then(()=>{h()}),h(),a}}const ne=[{title:"Motion Study",image:"/canvas/image-1.jpg",year:2024},{title:"Idle Form",image:"/canvas/image-2.jpg",year:2023},{title:"Blur Signal",image:"/canvas/image-3.jpg",year:2024},{title:"Still Drift",image:"/canvas/image-4.jpg",year:2023},{title:"Tidewalk",image:"/canvas/image-5.jpg",year:2024},{title:"Core Motion",image:"/canvas/image-6.jpg",year:2022},{title:"White Bloom",image:"/canvas/image-7.jpg",year:2024},{title:"Backrun",image:"/canvas/image-8.jpg",year:2023},{title:"Rushline",image:"/canvas/image-9.jpg",year:2024},{title:"Afterimage",image:"/canvas/image-1.jpg",year:2023},{title:"Shadowhead",image:"/canvas/image-2.jpg",year:2022},{title:"Opal Lace",image:"/canvas/image-3.jpg",year:2024},{title:"Glassprint",image:"/canvas/image-4.jpg",year:2024},{title:"Redshift",image:"/canvas/image-5.jpg",year:2023},{title:"White Noise",image:"/canvas/image-6.jpg",year:2023},{title:"Twin Field",image:"/canvas/image-7.jpg",year:2024},{title:"Petalloop",image:"/canvas/image-8.jpg",year:2023},{title:"Ghostwalk",image:"/canvas/image-9.jpg",year:2024},{title:"Heatwave",image:"/canvas/image-1.jpg",year:2023},{title:"Sky Drift",image:"/canvas/image-2.jpg",year:2024},{title:"Spindle",image:"/canvas/image-3.jpg",year:2022},{title:"Pacer",image:"/canvas/image-4.jpg",year:2023},{title:"Stride",image:"/canvas/image-5.jpg",year:2024},{title:"Cryo Pulse",image:"/canvas/image-6.jpg",year:2022},{title:"Velvet Blur",image:"/canvas/image-7.jpg",year:2024}],oa=`
  varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,aa=`
  uniform vec2 uOffset;
  uniform vec2 uResolution;
  uniform vec4 uBorderColor;
  uniform vec4 uHoverColor;
  uniform vec4 uBackgroundColor;
  uniform vec2 uMousePos;
  uniform float uZoom;
  uniform float uCellSize;
  uniform float uTextureCount;
  uniform float uDistortion;
  uniform float uTime;
  uniform float uFocusState;
  uniform float uFocusIndex;
  uniform sampler2D uImageAtlas;
  varying vec2 vUv;

  float random(vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
  }
  
  void main() {
    vec2 screenUV = (vUv - 0.5) * 2.0;
    
    float radius = length(screenUV);
    float distortion = 1.0 - uDistortion * radius * radius;
    vec2 distortedUV = screenUV * distortion;
    
    vec2 aspectRatio = vec2(uResolution.x / uResolution.y, 1.0);
    vec2 worldCoord = distortedUV * aspectRatio;
    
    worldCoord *= uZoom;
    worldCoord += uOffset;
    
    vec2 cellPos = worldCoord / uCellSize;
    vec2 cellId = floor(cellPos);
    vec2 cellUV = fract(cellPos);
    
    float texIndex = mod(cellId.x + cellId.y * 3.0, uTextureCount);
    if (texIndex < 0.0) texIndex += uTextureCount;
    texIndex = floor(texIndex);

    bool isFocused = abs(texIndex - uFocusIndex) < 0.1;

    vec2 mouseScreenUV = (uMousePos / uResolution) * 2.0 - 1.0;
    mouseScreenUV.y = -mouseScreenUV.y;
    
    float mouseRadius = length(mouseScreenUV);
    float mouseDistortion = 1.0 - uDistortion * mouseRadius * mouseRadius;
    vec2 mouseDistortedUV = mouseScreenUV * mouseDistortion;
    vec2 mouseWorldCoord = mouseDistortedUV * aspectRatio;
    
    mouseWorldCoord *= uZoom;
    mouseWorldCoord += uOffset;
    
    vec2 mouseCellPos = mouseWorldCoord / uCellSize;
    vec2 mouseCellId = floor(mouseCellPos);
    
    vec2 cellCenter = cellId + 0.5;
    vec2 mouseCellCenter = mouseCellId + 0.5;
    float cellDistance = length(cellCenter - mouseCellCenter);
    float hoverIntensity = 1.0 - smoothstep(0.4, 0.7, cellDistance);
    bool isHovered = hoverIntensity > 0.0 && uMousePos.x >= 0.0;
    
    vec3 color = vec3(0.0);
    float outAlpha = 0.0;
    
    float baseImageSize = 0.6;
    float targetImageSize = isFocused ? 0.96 : 0.6 * 0.7;
    float imageSize = mix(baseImageSize, targetImageSize, uFocusState);
    
    float imageBorder = (1.0 - imageSize) * 0.5;
    
    vec2 imageUV = (cellUV - imageBorder) / imageSize;
    
    float edgeSmooth = 0.01;
    vec2 imageMask = smoothstep(-edgeSmooth, edgeSmooth, imageUV) * 
                    smoothstep(-edgeSmooth, edgeSmooth, 1.0 - imageUV);
    float imageAlpha = imageMask.x * imageMask.y;
    
    bool inImageArea = imageUV.x >= 0.0 && imageUV.x <= 1.0 && imageUV.y >= 0.0 && imageUV.y <= 1.0;
    
    if (inImageArea && imageAlpha > 0.0) {
      float atlasSize = ceil(sqrt(uTextureCount));
      vec2 atlasPos = vec2(mod(texIndex, atlasSize), floor(texIndex / atlasSize));
      
      // Chromatic Aberration
      float caStrength = 0.02 * radius; 
      vec2 caOffset = screenUV * caStrength; 

      // R
      vec2 imageUVR = imageUV - caOffset;
      vec2 atlasUVR = (atlasPos + imageUVR) / atlasSize;
      atlasUVR.y = 1.0 - atlasUVR.y;
      
      // G
      vec2 imageUVG = imageUV;
      vec2 atlasUVG = (atlasPos + imageUVG) / atlasSize;
      atlasUVG.y = 1.0 - atlasUVG.y;
      
      // B
      vec2 imageUVB = imageUV + caOffset;
      vec2 atlasUVB = (atlasPos + imageUVB) / atlasSize;
      atlasUVB.y = 1.0 - atlasUVB.y;

      float r = texture2D(uImageAtlas, atlasUVR).r;
      float g = texture2D(uImageAtlas, atlasUVG).g;
      float b = texture2D(uImageAtlas, atlasUVB).b;
      float a = texture2D(uImageAtlas, atlasUVG).a;

      vec3 finalImageColor = vec3(r, g, b);
      
      // Darken non-focused images
      if (!isFocused) {
          finalImageColor *= mix(1.0, 0.1, uFocusState);
      }

      color = finalImageColor;
      outAlpha = imageAlpha * a;
    }
    
    float fade = 1.0 - smoothstep(1.2, 1.8, radius);

    outAlpha *= fade;
    gl_FragColor = vec4(color * fade, outAlpha);
  }
`,X={cellSize:.75,zoomLevel:1.25,lerpFactor:.05,borderColor:"rgba(255, 255, 255, 0.15)",hoverColor:"rgba(255, 255, 255, 0)"};let N,me,xt=!1,Nt=null,In=[],jt=[],Ke,J,Nn,Ue,Ct={x:0,y:0},Vt={angle:Math.PI/2,y:0},Ie={angle:Math.PI/2,y:0};const ca=Math.sqrt(50)/2.5;let Et,At,D,an=!1,cn=!0,xr=0,ae={x:0,y:0},xe={x:0,y:0},ce={x:0,y:0},Ve={x:0,y:0},zt={x:0,y:0},ze={x:-1,y:-1},ut=1,rt=1,vn=.08,Xn=.08,q=-1,Kt={value:0},Xt={value:1},He={x:0,y:0};const hs=o=>{const e=o.match(/rgba?\(([^)]+)\)/);return e?e[1].split(",").map((t,n)=>n<3?parseFloat(t.trim())/255:parseFloat(t.trim()||1)):[1,1,1,1]},la=o=>{const e=Math.ceil(Math.sqrt(o.length)),t=512,n=document.createElement("canvas");n.width=n.height=e*t;const s=n.getContext("2d");s.clearRect(0,0,n.width,n.height),o.forEach((i,c)=>{const a=c%e*t,l=Math.floor(c/e)*t;if(i.image?.complete){const h=i.image,u=h.width/h.height;let f=t,d=t,p=a,g=l;u>1?(d=t/u,g=l+(t-d)/2):(f=t*u,p=a+(t-f)/2),s.drawImage(h,p,g,f,d)}});const r=new Js(n);return Object.assign(r,{wrapS:et,wrapT:et,minFilter:W,magFilter:W,flipY:!1}),r},ua=()=>{const o=new Bn,e=[];let t=0;return new Promise(n=>{ne.forEach(s=>{const r=o.load(s.image,()=>{++t===ne.length&&n(e)});Object.assign(r,{wrapS:et,wrapT:et,minFilter:W,magFilter:W}),e.push(r),jt.push(r)})})},ha=(o,e,t)=>{let n={x:0,y:0},s=1/0;const r=20,i=Math.round(e),c=Math.round(t);for(let a=i-r;a<=i+r;a++)for(let l=c-r;l<=c+r;l++){let h=(a+l*3)%ne.length;if(h<0&&(h+=ne.length),h===o){const u=(a-e)**2+(l-t)**2;u<s&&(s=u,n={x:a,y:l})}}return s===1/0?(console.warn("Could not find nearest cell for index",o),{x:i,y:c}):n},Pn=o=>o.split("").map(e=>`<span style="display:inline-block; will-change: transform;">${e===" "?"&nbsp;":e}</span>`).join(""),fa=(o,e)=>{o.querySelector("span")||(o.innerHTML=Pn(o.textContent));const t=o.querySelectorAll("span");P.to(t,{y:"100%",opacity:0,stagger:.02,duration:.4,ease:"power2.in",onComplete:()=>{o.innerHTML=Pn(e);const n=o.querySelectorAll("span");P.fromTo(n,{y:"100%",opacity:0},{y:"0%",opacity:1,stagger:.02,duration:.4,ease:"power2.out"})}})},Er=o=>{const e=document.getElementById("archive-overlay"),t=document.getElementById("archive-title"),n=document.getElementById("archive-year");if(o!==-1){const s=ne[o].title,r=ne[o].year;t&&(e.style.opacity==="1"&&t.textContent.replace(/\u00a0/g," ")!==s?fa(t,s):(t.innerHTML=Pn(s),P.set(t.querySelectorAll("span"),{y:"0%",opacity:1}))),n&&(n.textContent=r),e&&(e.style.opacity="1",e.style.pointerEvents="auto")}else e&&(e.style.opacity="0",e.style.pointerEvents="none")},On=(o,e,t)=>{if(q===o&&He.x===e&&He.y===t)return;q=o,He={x:e,y:t},D?.material?.uniforms&&(D.material.uniforms.uFocusIndex.value=o),P.to(Kt,{value:1,duration:.8,ease:"power3.out",onUpdate:()=>{D?.material?.uniforms&&(D.material.uniforms.uFocusState.value=Kt.value)}}),P.to(Xt,{value:.05,duration:.8,ease:"power3.out",onUpdate:()=>{Ue?.uniforms.get("uOpacity")&&(Ue.uniforms.get("uOpacity").value=Xt.value)}});const n=(e+.5)*X.cellSize,s=(t+.5)*X.cellSize;ce.x=n,ce.y=s,Er(o)},Qe=()=>{q!==-1&&(q=-1,P.to(Kt,{value:0,duration:.6,ease:"power3.out",onUpdate:()=>{D?.material?.uniforms&&(D.material.uniforms.uFocusState.value=Kt.value)}}),P.to(Xt,{value:1,duration:.6,ease:"power3.out",onUpdate:()=>{Ue?.uniforms.get("uOpacity")&&(Ue.uniforms.get("uOpacity").value=Xt.value)}}),Er(-1))},Wt=o=>{if(q===-1)return;let e=q+o;e>=ne.length&&(e=0),e<0&&(e=ne.length-1);const t=He.x,n=He.y,s=ha(e,t,n);On(e,s.x,s.y)},da=()=>{const o=document.getElementById("gallery");if(!o||!N)return;const e=Math.max(1,o.offsetWidth||window.innerWidth||1),t=Math.max(1,o.offsetHeight||window.innerHeight||1);J&&(J.aspect=e/t,J.updateProjectionMatrix()),N.setSize(e,t),N.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),me&&me.setSize(e,t),D?.material?.uniforms&&D.material.uniforms.uResolution.value.set(e,t)},pa=o=>{if(Ct.x=o.clientX/window.innerWidth*2-1,Ct.y=-(o.clientY/window.innerHeight)*2+1,Vt.angle=Math.PI/2-Ct.x*.1,Vt.y=Ct.y*.4,!N)return;const e=N.domElement.getBoundingClientRect();ze.x=o.clientX-e.left,ze.y=o.clientY-e.top,D?.material?.uniforms&&D.material.uniforms.uMousePos.value.set(ze.x,ze.y);const t=ze.x/e.width*2-1,n=-(ze.y/e.height)*2+1,s=q!==-1?0:.05;if(zt.x=t*s,zt.y=n*s,an){const r=o.clientX-ae.x,i=o.clientY-ae.y;(Math.abs(r)>2||Math.abs(i)>2)&&(cn=!1,rt===1&&(rt=X.zoomLevel),q!==-1&&Qe()),ce.x-=r*.003,ce.y+=i*.003,ae.x=o.clientX,ae.y=o.clientY}},Ar=(o,e)=>{an=!0,cn=!0,xr=Date.now(),document.body.classList.add("dragging"),ae.x=o,ae.y=e,Xn=0},ma=o=>{o.target.closest(".nav-btn")||o.target.closest("#archive-close")||Ar(o.clientX,o.clientY)},ga=o=>{o.target.closest(".nav-btn")||o.target.closest("#archive-close")||(o.preventDefault(),Ar(o.touches[0].clientX,o.touches[0].clientY))},Tn=o=>{if(an=!1,document.body.classList.remove("dragging"),rt=1,Xn=.08,cn&&Date.now()-xr<200){const e=o.clientX||o.changedTouches?.[0]?.clientX,t=o.clientY||o.changedTouches?.[0]?.clientY;if(e!==void 0&&t!==void 0&&N){const n=N.domElement.getBoundingClientRect(),s=(e-n.left)/n.width*2-1,r=-((t-n.top)/n.height*2-1),i=Math.sqrt(s*s+r*r),c=1-.08*i*i;let a=s*c*(n.width/n.height)*ut+xe.x,l=r*c*ut+xe.y;const h=Math.floor(a/X.cellSize),u=Math.floor(l/X.cellSize),f=a/X.cellSize-h,d=l/X.cellSize-u,p=f>.15&&f<.85&&d>.15&&d<.85,g=Math.floor((h+u*3)%ne.length),m=g<0?ne.length+g:g;q===-1?p&&On(m,h,u):p?(m!==q||h!==He.x||u!==He.y)&&On(m,h,u):Qe()}}},va=o=>{q!==-1&&(o.key==="ArrowRight"&&Wt(1),o.key==="ArrowLeft"&&Wt(-1),o.key==="Escape"&&Qe())},z=(o,e,t,n)=>{o.addEventListener(e,t,n),In.push({target:o,type:e,handler:t,opts:n})},Ta=()=>{z(document,"mousedown",ma),z(document,"mousemove",pa),z(document,"mouseup",Tn),z(document,"mouseleave",Tn);const o={passive:!1};z(document,"touchstart",ga,o),z(document,"touchmove",s=>{if(s.preventDefault(),an){const r=s.touches[0],i=r.clientX-ae.x,c=r.clientY-ae.y;(Math.abs(i)>2||Math.abs(c)>2)&&(cn=!1,rt===1&&(rt=X.zoomLevel),q!==-1&&Qe()),ce.x-=i*.003,ce.y+=c*.003,ae.x=r.clientX,ae.y=r.clientY}},o),z(document,"touchend",Tn,o),z(window,"resize",da),z(document,"contextmenu",s=>s.preventDefault()),z(window,"keydown",va),z(window,"wheel",s=>{s.preventDefault();const r=.002;ce.x+=s.deltaX*r,ce.y-=s.deltaY*r,q!==-1&&(Math.abs(s.deltaX)>5||Math.abs(s.deltaY)>5)&&Qe()},{passive:!1});const e=document.getElementById("archive-close"),t=document.getElementById("archive-prev"),n=document.getElementById("archive-next");e&&z(e,"click",s=>{s.stopPropagation(),Qe()}),t&&z(t,"click",s=>{s.stopPropagation(),Wt(-1)}),n&&z(n,"click",s=>{s.stopPropagation(),Wt(1)})},yr=()=>{if(!xt)return;Nt=requestAnimationFrame(yr),Ie.angle+=(Vt.angle-Ie.angle)*.025,Ie.y+=(Vt.y-Ie.y)*.025;const o=window.scrollY,t=Math.max(.5,ca-o*.001);J&&(J.position.x=Math.cos(Ie.angle)*t,J.position.z=Math.sin(Ie.angle)*t,J.position.y=Ie.y+1,J.lookAt(0,0,0)),xe.x+=(ce.x-xe.x)*X.lerpFactor,xe.y+=(ce.y-xe.y)*X.lerpFactor,Ve.x+=(zt.x-Ve.x)*.05,Ve.y+=(zt.y-Ve.y)*.05,ut+=(rt-ut)*.15,vn+=(Xn-vn)*X.lerpFactor,D?.material?.uniforms&&(D.material.uniforms.uOffset.value.set(xe.x+Ve.x,xe.y+Ve.y),D.material.uniforms.uZoom.value=ut,D.material.uniforms.uDistortion.value=vn,D.material.uniforms.uTime.value=performance.now()*.001),me&&me.render(),N&&Et&&At&&(N.autoClear=!1,N.clearDepth(),N.render(Et,At),N.autoClear=!0)},xa=async()=>{const o=document.getElementById("gallery");if(!o)return;const e=Math.max(1,o.offsetWidth||window.innerWidth||1),t=Math.max(1,o.offsetHeight||window.innerHeight||1);N=new er({antialias:!0,alpha:!0}),N.setSize(e,t),N.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),N.toneMapping=Un,N.toneMappingExposure=1,N.setClearColor(0,0),o.appendChild(N.domElement),Ke=new pt,J=new wt(100,e/t,.1,1e3);const n=new tr(16777215,.5);Ke.add(n);const s=new Qt(16777215,1);s.position.set(5,5,5),Ke.add(s),new Ri().load("/home/scene.glb",d=>{Nn=d.scene,Ke.add(Nn)},void 0,d=>console.error("Failed to load scene.glb",d)),me=new mo(N);const i=new Zo(Ke,J);me.addPass(i),Ue=new ia({fontSize:54,cellSize:16,color:"#ffffff",fontFamily:"secondary"});const c=new sa(J,Ue);me.addPass(c),Et=new pt,At=new Rt(-1,1,1,-1,.1,10),At.position.z=1;const a=await ua(),l=la(a);jt.push(l);const h={uOffset:{value:new j(0,0)},uResolution:{value:new j(e,t)},uBorderColor:{value:new qn(...hs(X.borderColor))},uHoverColor:{value:new qn(...hs(X.hoverColor))},uMousePos:{value:new j(-1,-1)},uZoom:{value:1},uDistortion:{value:.08},uTime:{value:0},uCellSize:{value:X.cellSize},uTextureCount:{value:ne.length},uImageAtlas:{value:l},uFocusIndex:{value:-1},uFocusState:{value:0}},u=new Ir(2,2),f=new tt({vertexShader:oa,fragmentShader:aa,uniforms:h,transparent:!0});D=new yt(u,f),Et.add(D),Ta(),xt=!0,yr()};async function Ea(){xt||await xa()}function Dn(){xt&&(xt=!1,Nt&&(cancelAnimationFrame(Nt),Nt=null),In.forEach(({target:o,type:e,handler:t,opts:n})=>o.removeEventListener(e,t,n)),In=[],N&&(N.dispose(),N.domElement?.parentNode&&N.domElement.parentNode.removeChild(N.domElement)),me&&me.dispose(),D?.material&&D.material.dispose(),D?.geometry&&D.geometry.dispose(),jt.forEach(o=>o?.dispose?.()),jt=[],Ke=null,J=null,Et=null,At=null,Nn=null,D=null,Ue=null)}function fs(o,e){if(e===ys)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===Je||e===$t){let t=o.getIndex();if(t===null){const i=[],c=o.getAttribute("position");if(c!==void 0){for(let a=0;a<c.count;a++)i.push(a);o.setIndex(i),t=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}const n=t.count-2,s=[];if(e===Je)for(let i=1;i<=n;i++)s.push(t.getX(0)),s.push(t.getX(i)),s.push(t.getX(i+1));else for(let i=0;i<n;i++)i%2===0?(s.push(t.getX(i)),s.push(t.getX(i+1)),s.push(t.getX(i+2))):(s.push(t.getX(i+2)),s.push(t.getX(i+1)),s.push(t.getX(i)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=o.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}class Aa extends ws{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new ba(t)}),this.register(function(t){return new _a(t)}),this.register(function(t){return new Fa(t)}),this.register(function(t){return new ka(t)}),this.register(function(t){return new Ba(t)}),this.register(function(t){return new Ca(t)}),this.register(function(t){return new La(t)}),this.register(function(t){return new Ia(t)}),this.register(function(t){return new Na(t)}),this.register(function(t){return new Sa(t)}),this.register(function(t){return new Pa(t)}),this.register(function(t){return new Ma(t)}),this.register(function(t){return new Da(t)}),this.register(function(t){return new Oa(t)}),this.register(function(t){return new wa(t)}),this.register(function(t){return new Ha(t)}),this.register(function(t){return new Ga(t)})}load(e,t,n,s){const r=this;let i;if(this.resourcePath!=="")i=this.resourcePath;else if(this.path!==""){const l=le.extractUrlBase(e);i=le.resolveURL(l,this.path)}else i=le.extractUrlBase(e);this.manager.itemStart(e);const c=function(l){s?s(l):console.error(l),r.manager.itemError(e),r.manager.itemEnd(e)},a=new Yt(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{r.parse(l,i,function(h){t(h),r.manager.itemEnd(e)},c)}catch(h){c(h)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,s){let r;const i={},c={},a=new TextDecoder;if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(a.decode(new Uint8Array(e,0,4))===wr){try{i[R.KHR_BINARY_GLTF]=new Ua(e)}catch(u){s&&s(u);return}r=JSON.parse(i[R.KHR_BINARY_GLTF].content)}else r=JSON.parse(a.decode(e));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new ec(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const u=this.pluginCallbacks[h](l);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[u.name]=u,i[u.name]=!0}if(r.extensionsUsed)for(let h=0;h<r.extensionsUsed.length;++h){const u=r.extensionsUsed[h],f=r.extensionsRequired||[];switch(u){case R.KHR_MATERIALS_UNLIT:i[u]=new Ra;break;case R.KHR_DRACO_MESH_COMPRESSION:i[u]=new ja(r,this.dracoLoader);break;case R.KHR_TEXTURE_TRANSFORM:i[u]=new Va;break;case R.KHR_MESH_QUANTIZATION:i[u]=new za;break;default:f.indexOf(u)>=0&&c[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}l.setExtensions(i),l.setPlugins(c),l.parse(n,s)}parseAsync(e,t){const n=this;return new Promise(function(s,r){n.parse(e,t,s,r)})}}function ya(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const R={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class wa{constructor(e){this.parser=e,this.name=R.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let s=t.cache.get(n);if(s)return s;const r=t.json,a=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let l;const h=new V(16777215);a.color!==void 0&&h.setRGB(a.color[0],a.color[1],a.color[2],te);const u=a.range!==void 0?a.range:0;switch(a.type){case"directional":l=new Qt(h),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Ss(h),l.distance=u;break;case"spot":l=new Rs(h),l.distance=u,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,l.angle=a.spot.outerConeAngle,l.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return l.position.set(0,0,0),se(l,a),a.intensity!==void 0&&(l.intensity=a.intensity),l.name=t.createUniqueName(a.name||"light_"+e),s=Promise.resolve(l),t.cache.add(n,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],c=(r.extensions&&r.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(a){return n._getNodeRef(t.cache,c,a)})}}class Ra{constructor(){this.name=R.KHR_MATERIALS_UNLIT}getMaterialType(){return re}extendParams(e,t,n){const s=[];e.color=new V(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const i=r.baseColorFactor;e.color.setRGB(i[0],i[1],i[2],te),e.opacity=i[3]}r.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",r.baseColorTexture,K))}return Promise.all(s)}}class Sa{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class ba{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];if(i.clearcoatFactor!==void 0&&(t.clearcoat=i.clearcoatFactor),i.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",i.clearcoatTexture)),i.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=i.clearcoatRoughnessFactor),i.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),i.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",i.clearcoatNormalTexture)),i.clearcoatNormalTexture.scale!==void 0)){const c=i.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new j(c,c)}return Promise.all(r)}}class _a{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Ma{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return i.iridescenceFactor!==void 0&&(t.iridescence=i.iridescenceFactor),i.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),i.iridescenceIor!==void 0&&(t.iridescenceIOR=i.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),i.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),i.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),i.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(r)}}class Ca{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new V(0,0,0),t.sheenRoughness=0,t.sheen=1;const i=s.extensions[this.name];if(i.sheenColorFactor!==void 0){const c=i.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],te)}return i.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=i.sheenRoughnessFactor),i.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",i.sheenColorTexture,K)),i.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(r)}}class La{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return i.transmissionFactor!==void 0&&(t.transmission=i.transmissionFactor),i.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(r)}}class Ia{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];t.thickness=i.thicknessFactor!==void 0?i.thicknessFactor:0,i.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",i.thicknessTexture)),t.attenuationDistance=i.attenuationDistance||1/0;const c=i.attenuationColor||[1,1,1];return t.attenuationColor=new V().setRGB(c[0],c[1],c[2],te),Promise.all(r)}}class Na{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class Pa{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];t.specularIntensity=i.specularFactor!==void 0?i.specularFactor:1,i.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",i.specularTexture));const c=i.specularColorFactor||[1,1,1];return t.specularColor=new V().setRGB(c[0],c[1],c[2],te),i.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",i.specularColorTexture,K)),Promise.all(r)}}class Oa{constructor(e){this.parser=e,this.name=R.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return t.bumpScale=i.bumpFactor!==void 0?i.bumpFactor:1,i.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(r)}}class Da{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:F}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],i=s.extensions[this.name];return i.anisotropyStrength!==void 0&&(t.anisotropy=i.anisotropyStrength),i.anisotropyRotation!==void 0&&(t.anisotropyRotation=i.anisotropyRotation),i.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(r)}}class Fa{constructor(e){this.parser=e,this.name=R.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,s=n.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,i)}}class ka{constructor(e){this.parser=e,this.name=R.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const i=r.extensions[t],c=s.images[i.source];let a=n.textureLoader;if(c.uri){const l=n.options.manager.getHandler(c.uri);l!==null&&(a=l)}return n.loadTextureImage(e,i.source,a)}}class Ba{constructor(e){this.parser=e,this.name=R.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const i=r.extensions[t],c=s.images[i.source];let a=n.textureLoader;if(c.uri){const l=n.options.manager.getHandler(c.uri);l!==null&&(a=l)}return n.loadTextureImage(e,i.source,a)}}class Ha{constructor(e){this.name=R.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const s=n.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(c){const a=s.byteOffset||0,l=s.byteLength||0,h=s.count,u=s.byteStride,f=new Uint8Array(c,a,l);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(h,u,f,s.mode,s.filter).then(function(d){return d.buffer}):i.ready.then(function(){const d=new ArrayBuffer(h*u);return i.decodeGltfBuffer(new Uint8Array(d),h,u,f,s.mode,s.filter),d})})}else return null}}class Ga{constructor(e){this.name=R.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const l of s.primitives)if(l.mode!==Z.TRIANGLES&&l.mode!==Z.TRIANGLE_STRIP&&l.mode!==Z.TRIANGLE_FAN&&l.mode!==void 0)return null;const i=n.extensions[this.name].attributes,c=[],a={};for(const l in i)c.push(this.parser.getDependency("accessor",i[l]).then(h=>(a[l]=h,a[l])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(l=>{const h=l.pop(),u=h.isGroup?h.children:[h],f=l[0].count,d=[];for(const p of u){const g=new Se,m=new ee,v=new Zt,T=new ee(1,1,1),E=new bs(p.geometry,p.material,f);for(let x=0;x<f;x++)a.TRANSLATION&&m.fromBufferAttribute(a.TRANSLATION,x),a.ROTATION&&v.fromBufferAttribute(a.ROTATION,x),a.SCALE&&T.fromBufferAttribute(a.SCALE,x),E.setMatrixAt(x,g.compose(m,v,T));for(const x in a)if(x==="_COLOR_0"){const b=a[x];E.instanceColor=new _s(b.array,b.itemSize,b.normalized)}else x!=="TRANSLATION"&&x!=="ROTATION"&&x!=="SCALE"&&p.geometry.setAttribute(x,a[x]);Jt.prototype.copy.call(E,p),this.parser.assignFinalMaterial(E),d.push(E)}return h.isGroup?(h.clear(),h.add(...d),h):d[0]}))}}const wr="glTF",ct=12,ds={JSON:1313821514,BIN:5130562};class Ua{constructor(e){this.name=R.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,ct),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==wr)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-ct,r=new DataView(e,ct);let i=0;for(;i<s;){const c=r.getUint32(i,!0);i+=4;const a=r.getUint32(i,!0);if(i+=4,a===ds.JSON){const l=new Uint8Array(e,ct+i,c);this.content=n.decode(l)}else if(a===ds.BIN){const l=ct+i;this.body=e.slice(l,l+c)}i+=c}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ja{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=R.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,c={},a={},l={};for(const h in i){const u=Fn[h]||h.toLowerCase();c[u]=i[h]}for(const h in e.attributes){const u=Fn[h]||h.toLowerCase();if(i[h]!==void 0){const f=n.accessors[e.attributes[h]],d=Ze[f.componentType];l[u]=d.name,a[u]=f.normalized===!0}}return t.getDependency("bufferView",r).then(function(h){return new Promise(function(u,f){s.decodeDracoFile(h,function(d){for(const p in d.attributes){const g=d.attributes[p],m=a[p];m!==void 0&&(g.normalized=m)}u(d)},c,l,te,f)})})}}class Va{constructor(){this.name=R.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class za{constructor(){this.name=R.KHR_MESH_QUANTIZATION}}class Rr extends qs{constructor(e,t,n,s){super(e,t,n,s)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let i=0;i!==s;i++)t[i]=n[r+i];return t}interpolate_(e,t,n,s){const r=this.resultBuffer,i=this.sampleValues,c=this.valueSize,a=c*2,l=c*3,h=s-t,u=(n-t)/h,f=u*u,d=f*u,p=e*l,g=p-l,m=-2*d+3*f,v=d-f,T=1-m,E=v-f+u;for(let x=0;x!==c;x++){const b=i[g+x+c],L=i[g+x+a]*h,A=i[p+x+c],O=i[p+x]*h;r[x]=T*b+E*L+m*A+v*O}return r}}const Ka=new Zt;class Xa extends Rr{interpolate_(e,t,n,s){const r=super.interpolate_(e,t,n,s);return Ka.fromArray(r).normalize().toArray(r),r}}const Z={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ze={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ps={9728:dt,9729:W,9984:Ns,9985:Is,9986:Ls,9987:en},ms={33071:et,33648:Ps,10497:be},xn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Fn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ve={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Wa={CUBICSPLINE:void 0,LINEAR:sn,STEP:Xs},En={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function qa(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new tn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Hn})),o.DefaultMaterial}function Ne(o,e,t){for(const n in t.extensions)o[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function se(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function $a(o,e,t){let n=!1,s=!1,r=!1;for(let l=0,h=e.length;l<h;l++){const u=e[l];if(u.POSITION!==void 0&&(n=!0),u.NORMAL!==void 0&&(s=!0),u.COLOR_0!==void 0&&(r=!0),n&&s&&r)break}if(!n&&!s&&!r)return Promise.resolve(o);const i=[],c=[],a=[];for(let l=0,h=e.length;l<h;l++){const u=e[l];if(n){const f=u.POSITION!==void 0?t.getDependency("accessor",u.POSITION):o.attributes.position;i.push(f)}if(s){const f=u.NORMAL!==void 0?t.getDependency("accessor",u.NORMAL):o.attributes.normal;c.push(f)}if(r){const f=u.COLOR_0!==void 0?t.getDependency("accessor",u.COLOR_0):o.attributes.color;a.push(f)}}return Promise.all([Promise.all(i),Promise.all(c),Promise.all(a)]).then(function(l){const h=l[0],u=l[1],f=l[2];return n&&(o.morphAttributes.position=h),s&&(o.morphAttributes.normal=u),r&&(o.morphAttributes.color=f),o.morphTargetsRelative=!0,o})}function Ya(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let n=0,s=t.length;n<s;n++)o.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Qa(o){let e;const t=o.extensions&&o.extensions[R.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+An(t.attributes):e=o.indices+":"+An(o.attributes)+":"+o.mode,o.targets!==void 0)for(let n=0,s=o.targets.length;n<s;n++)e+=":"+An(o.targets[n]);return e}function An(o){let e="";const t=Object.keys(o).sort();for(let n=0,s=t.length;n<s;n++)e+=t[n]+":"+o[t[n]]+";";return e}function kn(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Za(o){return o.search(/\.jpe?g($|\?)/i)>0||o.search(/^data\:image\/jpeg/)===0?"image/jpeg":o.search(/\.webp($|\?)/i)>0||o.search(/^data\:image\/webp/)===0?"image/webp":o.search(/\.ktx2($|\?)/i)>0||o.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const Ja=new Se;class ec{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new ya,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=-1,r=!1,i=-1;if(typeof navigator<"u"){const c=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(c)===!0;const a=c.match(/Version\/(\d+)/);s=n&&a?parseInt(a[1],10):-1,r=c.indexOf("Firefox")>-1,i=r?c.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&s<17||r&&i<98?this.textureLoader=new Bn(this.options.manager):this.textureLoader=new Ms(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Yt(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(i){return i._markDefs&&i._markDefs()}),Promise.all(this._invokeAll(function(i){return i.beforeRoot&&i.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(i){const c={scene:i[0][s.scene||0],scenes:i[0],animations:i[1],cameras:i[2],asset:s.asset,parser:n,userData:{}};return Ne(r,c,s),se(c,s),Promise.all(n._invokeAll(function(a){return a.afterRoot&&a.afterRoot(c)})).then(function(){for(const a of c.scenes)a.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let s=0,r=t.length;s<r;s++){const i=t[s].joints;for(let c=0,a=i.length;c<a;c++)e[i[c]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const i=e[s];i.mesh!==void 0&&(this._addNodeRef(this.meshCache,i.mesh),i.skin!==void 0&&(n[i.mesh].isSkinnedMesh=!0)),i.camera!==void 0&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const s=n.clone(),r=(i,c)=>{const a=this.associations.get(i);a!=null&&this.associations.set(c,a);for(const[l,h]of i.children.entries())r(h,c.children[l])};return r(n,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const s=e(t[n]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let s=0;s<t.length;s++){const r=e(t[s]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let s=this.cache.get(n);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(n,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(r,i){return n.getDependency(e,i)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[R.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,i){n.load(le.resolveURL(t.uri,s.path),r,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+s)})}loadAccessor(e){const t=this,n=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const i=xn[s.type],c=Ze[s.componentType],a=s.normalized===!0,l=new c(s.count*i);return Promise.resolve(new we(l,i,a))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(i){const c=i[0],a=xn[s.type],l=Ze[s.componentType],h=l.BYTES_PER_ELEMENT,u=h*a,f=s.byteOffset||0,d=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0,p=s.normalized===!0;let g,m;if(d&&d!==u){const v=Math.floor(f/d),T="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+v+":"+s.count;let E=t.cache.get(T);E||(g=new l(c,v*d,s.count*d/h),E=new Cs(g,d/h),t.cache.add(T,E)),m=new Ws(E,a,f%d/h,p)}else c===null?g=new l(s.count*a):g=new l(c,f,s.count*a),m=new we(g,a,p);if(s.sparse!==void 0){const v=xn.SCALAR,T=Ze[s.sparse.indices.componentType],E=s.sparse.indices.byteOffset||0,x=s.sparse.values.byteOffset||0,b=new T(i[1],E,s.sparse.count*v),L=new l(i[2],x,s.sparse.count*a);c!==null&&(m=new we(m.array.slice(),m.itemSize,m.normalized)),m.normalized=!1;for(let A=0,O=b.length;A<O;A++){const I=b[A];if(m.setX(I,L[A*a]),a>=2&&m.setY(I,L[A*a+1]),a>=3&&m.setZ(I,L[A*a+2]),a>=4&&m.setW(I,L[A*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}m.normalized=p}return m})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,i=t.images[r];let c=this.textureLoader;if(i.uri){const a=n.manager.getHandler(i.uri);a!==null&&(c=a)}return this.loadTextureImage(e,r,c)}loadTextureImage(e,t,n){const s=this,r=this.json,i=r.textures[e],c=r.images[t],a=(c.uri||c.bufferView)+":"+i.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(t,n).then(function(h){h.flipY=!1,h.name=i.name||c.name||"",h.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(h.name=c.uri);const f=(r.samplers||{})[i.sampler]||{};return h.magFilter=ps[f.magFilter]||W,h.minFilter=ps[f.minFilter]||en,h.wrapS=ms[f.wrapS]||be,h.wrapT=ms[f.wrapT]||be,h.generateMipmaps=!h.isCompressedTexture&&h.minFilter!==dt&&h.minFilter!==W,s.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[a]=l,l}loadImageSource(e,t){const n=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const i=s.images[e],c=self.URL||self.webkitURL;let a=i.uri||"",l=!1;if(i.bufferView!==void 0)a=n.getDependency("bufferView",i.bufferView).then(function(u){l=!0;const f=new Blob([u],{type:i.mimeType});return a=c.createObjectURL(f),a});else if(i.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(a).then(function(u){return new Promise(function(f,d){let p=f;t.isImageBitmapLoader===!0&&(p=function(g){const m=new Ge(g);m.needsUpdate=!0,f(m)}),t.load(le.resolveURL(u,r.path),p,void 0,d)})}).then(function(u){return l===!0&&c.revokeObjectURL(a),se(u,i),u.userData.mimeType=i.mimeType||Za(i.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),u});return this.sourceCache[e]=h,h}assignTexture(e,t,n,s){const r=this;return this.getDependency("texture",n.index).then(function(i){if(!i)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(i=i.clone(),i.channel=n.texCoord),r.extensions[R.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[R.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const a=r.associations.get(i);i=r.extensions[R.KHR_TEXTURE_TRANSFORM].extendTexture(i,c),r.associations.set(i,a)}}return s!==void 0&&(i.colorSpace=s),e[t]=i,i})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,i=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let a=this.cache.get(c);a||(a=new Os,Re.prototype.copy.call(a,n),a.color.copy(n.color),a.map=n.map,a.sizeAttenuation=!1,this.cache.add(c,a)),n=a}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let a=this.cache.get(c);a||(a=new Ds,Re.prototype.copy.call(a,n),a.color.copy(n.color),a.map=n.map,this.cache.add(c,a)),n=a}if(s||r||i){let c="ClonedMaterial:"+n.uuid+":";s&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),i&&(c+="flat-shading:");let a=this.cache.get(c);a||(a=n.clone(),r&&(a.vertexColors=!0),i&&(a.flatShading=!0),s&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(c,a),this.associations.set(a,this.associations.get(n))),n=a}e.material=n}getMaterialType(){return tn}loadMaterial(e){const t=this,n=this.json,s=this.extensions,r=n.materials[e];let i;const c={},a=r.extensions||{},l=[];if(a[R.KHR_MATERIALS_UNLIT]){const u=s[R.KHR_MATERIALS_UNLIT];i=u.getMaterialType(),l.push(u.extendParams(c,r,t))}else{const u=r.pbrMetallicRoughness||{};if(c.color=new V(1,1,1),c.opacity=1,Array.isArray(u.baseColorFactor)){const f=u.baseColorFactor;c.color.setRGB(f[0],f[1],f[2],te),c.opacity=f[3]}u.baseColorTexture!==void 0&&l.push(t.assignTexture(c,"map",u.baseColorTexture,K)),c.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,c.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(l.push(t.assignTexture(c,"metalnessMap",u.metallicRoughnessTexture)),l.push(t.assignTexture(c,"roughnessMap",u.metallicRoughnessTexture))),i=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,c)})))}r.doubleSided===!0&&(c.side=Xe);const h=r.alphaMode||En.OPAQUE;if(h===En.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,h===En.MASK&&(c.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&i!==re&&(l.push(t.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new j(1,1),r.normalTexture.scale!==void 0)){const u=r.normalTexture.scale;c.normalScale.set(u,u)}if(r.occlusionTexture!==void 0&&i!==re&&(l.push(t.assignTexture(c,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&i!==re){const u=r.emissiveFactor;c.emissive=new V().setRGB(u[0],u[1],u[2],te)}return r.emissiveTexture!==void 0&&i!==re&&l.push(t.assignTexture(c,"emissiveMap",r.emissiveTexture,K)),Promise.all(l).then(function(){const u=new i(c);return r.name&&(u.name=r.name),se(u,r),t.associations.set(u,{materials:e}),r.extensions&&Ne(s,u,r),u})}createUniqueName(e){const t=Fs.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,s=this.primitiveCache;function r(c){return n[R.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(a){return gs(a,c,t)})}const i=[];for(let c=0,a=e.length;c<a;c++){const l=e[c],h=Qa(l),u=s[h];if(u)i.push(u.promise);else{let f;l.extensions&&l.extensions[R.KHR_DRACO_MESH_COMPRESSION]?f=r(l):f=gs(new nn,l,t),s[h]={primitive:l,promise:f},i.push(f)}}return Promise.all(i)}loadMesh(e){const t=this,n=this.json,s=this.extensions,r=n.meshes[e],i=r.primitives,c=[];for(let a=0,l=i.length;a<l;a++){const h=i[a].material===void 0?qa(this.cache):this.getDependency("material",i[a].material);c.push(h)}return c.push(t.loadGeometries(i)),Promise.all(c).then(function(a){const l=a.slice(0,a.length-1),h=a[a.length-1],u=[];for(let d=0,p=h.length;d<p;d++){const g=h[d],m=i[d];let v;const T=l[d];if(m.mode===Z.TRIANGLES||m.mode===Z.TRIANGLE_STRIP||m.mode===Z.TRIANGLE_FAN||m.mode===void 0)v=r.isSkinnedMesh===!0?new ks(g,T):new yt(g,T),v.isSkinnedMesh===!0&&v.normalizeSkinWeights(),m.mode===Z.TRIANGLE_STRIP?v.geometry=fs(v.geometry,$t):m.mode===Z.TRIANGLE_FAN&&(v.geometry=fs(v.geometry,Je));else if(m.mode===Z.LINES)v=new Bs(g,T);else if(m.mode===Z.LINE_STRIP)v=new Hs(g,T);else if(m.mode===Z.LINE_LOOP)v=new Gs(g,T);else if(m.mode===Z.POINTS)v=new Us(g,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(v.geometry.morphAttributes).length>0&&Ya(v,r),v.name=t.createUniqueName(r.name||"mesh_"+e),se(v,r),m.extensions&&Ne(s,v,m),t.assignFinalMaterial(v),u.push(v)}for(let d=0,p=u.length;d<p;d++)t.associations.set(u[d],{meshes:e,primitives:d});if(u.length===1)return r.extensions&&Ne(s,u[0],r),u[0];const f=new qe;r.extensions&&Ne(s,f,r),t.associations.set(f,{meshes:e});for(let d=0,p=u.length;d<p;d++)f.add(u[d]);return f})}loadCamera(e){let t;const n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new wt(js.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new Rt(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),se(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let s=0,r=t.joints.length;s<r;s++)n.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(s){const r=s.pop(),i=s,c=[],a=[];for(let l=0,h=i.length;l<h;l++){const u=i[l];if(u){c.push(u);const f=new Se;r!==null&&f.fromArray(r.array,l*16),a.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Vs(c,a)})}loadAnimation(e){const t=this.json,n=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,i=[],c=[],a=[],l=[],h=[];for(let u=0,f=s.channels.length;u<f;u++){const d=s.channels[u],p=s.samplers[d.sampler],g=d.target,m=g.node,v=s.parameters!==void 0?s.parameters[p.input]:p.input,T=s.parameters!==void 0?s.parameters[p.output]:p.output;g.node!==void 0&&(i.push(this.getDependency("node",m)),c.push(this.getDependency("accessor",v)),a.push(this.getDependency("accessor",T)),l.push(p),h.push(g))}return Promise.all([Promise.all(i),Promise.all(c),Promise.all(a),Promise.all(l),Promise.all(h)]).then(function(u){const f=u[0],d=u[1],p=u[2],g=u[3],m=u[4],v=[];for(let E=0,x=f.length;E<x;E++){const b=f[E],L=d[E],A=p[E],O=g[E],I=m[E];if(b===void 0)continue;b.updateMatrix&&b.updateMatrix();const y=n._createAnimationTracks(b,L,A,O,I);if(y)for(let H=0;H<y.length;H++)v.push(y[H])}const T=new zs(r,void 0,v);return se(T,s),T})}createNodeMesh(e){const t=this.json,n=this,s=t.nodes[e];return s.mesh===void 0?null:n.getDependency("mesh",s.mesh).then(function(r){const i=n._getNodeRef(n.meshCache,s.mesh,r);return s.weights!==void 0&&i.traverse(function(c){if(c.isMesh)for(let a=0,l=s.weights.length;a<l;a++)c.morphTargetInfluences[a]=s.weights[a]}),i})}loadNode(e){const t=this.json,n=this,s=t.nodes[e],r=n._loadNodeShallow(e),i=[],c=s.children||[];for(let l=0,h=c.length;l<h;l++)i.push(n.getDependency("node",c[l]));const a=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([r,Promise.all(i),a]).then(function(l){const h=l[0],u=l[1],f=l[2];f!==null&&h.traverse(function(d){d.isSkinnedMesh&&d.bind(f,Ja)});for(let d=0,p=u.length;d<p;d++)h.add(u[d]);return h})}_loadNodeShallow(e){const t=this.json,n=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],i=r.name?s.createUniqueName(r.name):"",c=[],a=s._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return a&&c.push(a),r.camera!==void 0&&c.push(s.getDependency("camera",r.camera).then(function(l){return s._getNodeRef(s.cameraCache,r.camera,l)})),s._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){c.push(l)}),this.nodeCache[e]=Promise.all(c).then(function(l){let h;if(r.isBone===!0?h=new Ks:l.length>1?h=new qe:l.length===1?h=l[0]:h=new Jt,h!==l[0])for(let u=0,f=l.length;u<f;u++)h.add(l[u]);if(r.name&&(h.userData.name=r.name,h.name=i),se(h,r),r.extensions&&Ne(n,h,r),r.matrix!==void 0){const u=new Se;u.fromArray(r.matrix),h.applyMatrix4(u)}else r.translation!==void 0&&h.position.fromArray(r.translation),r.rotation!==void 0&&h.quaternion.fromArray(r.rotation),r.scale!==void 0&&h.scale.fromArray(r.scale);if(!s.associations.has(h))s.associations.set(h,{});else if(r.mesh!==void 0&&s.meshCache.refs[r.mesh]>1){const u=s.associations.get(h);s.associations.set(h,{...u})}return s.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],s=this,r=new qe;n.name&&(r.name=s.createUniqueName(n.name)),se(r,n),n.extensions&&Ne(t,r,n);const i=n.nodes||[],c=[];for(let a=0,l=i.length;a<l;a++)c.push(s.getDependency("node",i[a]));return Promise.all(c).then(function(a){for(let h=0,u=a.length;h<u;h++)r.add(a[h]);const l=h=>{const u=new Map;for(const[f,d]of s.associations)(f instanceof Re||f instanceof Ge)&&u.set(f,d);return h.traverse(f=>{const d=s.associations.get(f);d!=null&&u.set(f,d)}),u};return s.associations=l(r),r})}_createAnimationTracks(e,t,n,s,r){const i=[],c=e.name?e.name:e.uuid,a=[];ve[r.path]===ve.weights?e.traverse(function(f){f.morphTargetInfluences&&a.push(f.name?f.name:f.uuid)}):a.push(c);let l;switch(ve[r.path]){case ve.weights:l=Dt;break;case ve.rotation:l=Ft;break;case ve.translation:case ve.scale:l=Ot;break;default:n.itemSize===1?l=Dt:l=Ot;break}const h=s.interpolation!==void 0?Wa[s.interpolation]:sn,u=this._getArrayFromAccessor(n);for(let f=0,d=a.length;f<d;f++){const p=new l(a[f]+"."+ve[r.path],t.array,u,h);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),i.push(p)}return i}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=kn(t.constructor),s=new Float32Array(t.length);for(let r=0,i=t.length;r<i;r++)s[r]=t[r]*n;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const s=this instanceof Ft?Xa:Rr;return new s(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function tc(o,e,t){const n=e.attributes,s=new $s;if(n.POSITION!==void 0){const c=t.json.accessors[n.POSITION],a=c.min,l=c.max;if(a!==void 0&&l!==void 0){if(s.set(new ee(a[0],a[1],a[2]),new ee(l[0],l[1],l[2])),c.normalized){const h=kn(Ze[c.componentType]);s.min.multiplyScalar(h),s.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const c=new ee,a=new ee;for(let l=0,h=r.length;l<h;l++){const u=r[l];if(u.POSITION!==void 0){const f=t.json.accessors[u.POSITION],d=f.min,p=f.max;if(d!==void 0&&p!==void 0){if(a.setX(Math.max(Math.abs(d[0]),Math.abs(p[0]))),a.setY(Math.max(Math.abs(d[1]),Math.abs(p[1]))),a.setZ(Math.max(Math.abs(d[2]),Math.abs(p[2]))),f.normalized){const g=kn(Ze[f.componentType]);a.multiplyScalar(g)}c.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(c)}o.boundingBox=s;const i=new Ys;s.getCenter(i.center),i.radius=s.min.distanceTo(s.max)/2,o.boundingSphere=i}function gs(o,e,t){const n=e.attributes,s=[];function r(i,c){return t.getDependency("accessor",i).then(function(a){o.setAttribute(c,a)})}for(const i in n){const c=Fn[i]||i.toLowerCase();c in o.attributes||s.push(r(n[i],c))}if(e.indices!==void 0&&!o.index){const i=t.getDependency("accessor",e.indices).then(function(c){o.setIndex(c)});s.push(i)}return wn.workingColorSpace!==te&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${wn.workingColorSpace}" not supported.`),se(o,e),tc(o,e,t),Promise.all(s).then(function(){return e.targets!==void 0?$a(o,e.targets,t):o})}const nc={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class bt{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const sc=new Rt(-1,1,1,-1,0,1);class rc extends nn{constructor(){super(),this.setAttribute("position",new $n([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new $n([0,2,0,0,2,0],2))}}const ic=new rc;class Sr{constructor(e){this._mesh=new yt(ic,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,sc)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class oc extends bt{constructor(e,t="tDiffuse"){super(),this.textureID=t,this.uniforms=null,this.material=null,e instanceof tt?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=nr.clone(e.uniforms),this.material=new tt({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new Sr(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class vs extends bt{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const s=e.getContext(),r=e.state;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0);let i,c;this.inverse?(i=0,c=1):(i=1,c=0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),r.buffers.stencil.setFunc(s.ALWAYS,i,4294967295),r.buffers.stencil.setClear(c),r.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.color.setMask(!0),r.buffers.depth.setMask(!0),r.buffers.stencil.setLocked(!1),r.buffers.stencil.setFunc(s.EQUAL,1,4294967295),r.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),r.buffers.stencil.setLocked(!0)}}class ac extends bt{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class cc{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const n=e.getSize(new j);this._width=n.width,this._height=n.height,t=new St(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Nr}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new oc(nc),this.copyPass.material.blending=Gn,this.clock=new Pr}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let s=0,r=this.passes.length;s<r;s++){const i=this.passes[s];if(i.enabled!==!1){if(i.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),i.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),i.needsSwap){if(n){const c=this.renderer.getContext(),a=this.renderer.state.buffers.stencil;a.setFunc(c.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.setFunc(c.EQUAL,1,4294967295)}this.swapBuffers()}vs!==void 0&&(i instanceof vs?n=!0:i instanceof ac&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new j);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(n,s),this.renderTarget2.setSize(n,s);for(let r=0;r<this.passes.length;r++)this.passes[r].setSize(n,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class lc extends bt{constructor(e,t,n=null,s=null,r=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=s,this.clearAlpha=r,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new V}render(e,t,n){const s=e.autoClear;e.autoClear=!1;let r,i;this.overrideMaterial!==null&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(r=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(r),this.overrideMaterial!==null&&(this.scene.overrideMaterial=i),e.autoClear=s}}const Lt={name:"OutputShader",uniforms:{tDiffuse:{value:null},toneMappingExposure:{value:1}},vertexShader:`
		precision highp float;

		uniform mat4 modelViewMatrix;
		uniform mat4 projectionMatrix;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D tDiffuse;

		#include <tonemapping_pars_fragment>
		#include <colorspace_pars_fragment>

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );

			// tone mapping

			#ifdef LINEAR_TONE_MAPPING

				gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );

			#elif defined( REINHARD_TONE_MAPPING )

				gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );

			#elif defined( CINEON_TONE_MAPPING )

				gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );

			#elif defined( ACES_FILMIC_TONE_MAPPING )

				gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );

			#elif defined( AGX_TONE_MAPPING )

				gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );

			#elif defined( NEUTRAL_TONE_MAPPING )

				gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );

			#elif defined( CUSTOM_TONE_MAPPING )

				gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );

			#endif

			// color space

			#ifdef SRGB_TRANSFER

				gl_FragColor = sRGBTransferOETF( gl_FragColor );

			#endif

		}`};class uc extends bt{constructor(){super(),this.uniforms=nr.clone(Lt.uniforms),this.material=new Or({name:Lt.name,uniforms:this.uniforms,vertexShader:Lt.vertexShader,fragmentShader:Lt.fragmentShader}),this._fsQuad=new Sr(this.material),this._outputColorSpace=null,this._toneMapping=null}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.toneMappingExposure.value=e.toneMappingExposure,(this._outputColorSpace!==e.outputColorSpace||this._toneMapping!==e.toneMapping)&&(this._outputColorSpace=e.outputColorSpace,this._toneMapping=e.toneMapping,this.material.defines={},wn.getTransfer(this._outputColorSpace)===Dr&&(this.material.defines.SRGB_TRANSFER=""),this._toneMapping===Fr?this.material.defines.LINEAR_TONE_MAPPING="":this._toneMapping===kr?this.material.defines.REINHARD_TONE_MAPPING="":this._toneMapping===Br?this.material.defines.CINEON_TONE_MAPPING="":this._toneMapping===Un?this.material.defines.ACES_FILMIC_TONE_MAPPING="":this._toneMapping===Hr?this.material.defines.AGX_TONE_MAPPING="":this._toneMapping===Gr?this.material.defines.NEUTRAL_TONE_MAPPING="":this._toneMapping===Ur&&(this.material.defines.CUSTOM_TONE_MAPPING=""),this.material.needsUpdate=!0),this.renderToScreen===!0?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}let k=null,de=null,Y=null,Pe=null,ht=null,ft=null,Pt=null,Oe=null,qt=!1;function hc(){if(qt)return;if(qt=!0,Pe=new pt,Y=new wt(100,window.innerWidth/window.innerHeight,.1,1e3),k=new er({antialias:!0,alpha:!0}),k.setSize(window.innerWidth,window.innerHeight),k.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),k.toneMapping=Un,k.toneMappingExposure=1,k.shadowMap.enabled=!0,k.shadowMap.type=jr,Oe=document.querySelector("#background"),!Oe){Oe=document.createElement("div"),Oe.id="background";const u=document.body.firstChild;document.body.insertBefore(Oe,u)}Oe.appendChild(k.domElement);const o=new tr(16777215,.5);Pe.add(o);const e=new Qt(16777215,1);e.position.set(5,5,5),Pe.add(e),new Aa().load("/home/scene.glb",u=>{Pe.add(u.scene)},void 0,u=>console.error("GLTF load error:",u)),ht=()=>{!Y||!k||!de||(Y.aspect=window.innerWidth/window.innerHeight,Y.updateProjectionMatrix(),k.setSize(window.innerWidth,window.innerHeight),de.setSize(window.innerWidth,window.innerHeight))},window.addEventListener("resize",ht),de=new cc(k);const s=new lc(Pe,Y);de.addPass(s);const r=new uc;de.addPass(r);let i={x:0,y:0},c={angle:Math.PI/2,y:0},a={angle:Math.PI/2,y:0};const l=Math.sqrt(50)/2.5;ft=u=>{i.x=u.clientX/window.innerWidth*2-1,i.y=-(u.clientY/window.innerHeight)*2+1,c.angle=Math.PI/2-i.x*.1,c.y=i.y*.4},document.addEventListener("mousemove",ft);const h=()=>{a.angle+=(c.angle-a.angle)*.025,a.y+=(c.y-a.y)*.025;const u=window.scrollY,d=Math.max(.5,l-u*.001);Y.position.x=Math.cos(a.angle)*d,Y.position.z=Math.sin(a.angle)*d,Y.position.y+=a.y+1-Y.position.y,Y.lookAt(0,0,0),de.render(),Pt=requestAnimationFrame(h)};return h(),{scene:Pe,camera:Y,renderer:k}}function yn(){qt&&(qt=!1,Pt&&(cancelAnimationFrame(Pt),Pt=null),ht&&(window.removeEventListener("resize",ht),ht=null),ft&&(document.removeEventListener("mousemove",ft),ft=null),de&&(de.dispose(),de=null),k&&(k.dispose(),k.domElement&&k.domElement.parentNode&&k.domElement.parentNode.removeChild(k.domElement),k=null),Pe=null,Y=null,Oe=null)}function Ts(){const o=document.getElementById("time");if(o){const e=new Date,t=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),s=String(e.getSeconds()).padStart(2,"0");o.textContent=`${t}:${n}:${s} IST`}}function fc(){Ts(),window.timeInterval&&clearInterval(window.timeInterval),window.timeInterval=setInterval(Ts,1e3)}function Wn(o){fc(),zr(),ur(),lr();const e=o||document.querySelector('[data-barba="container"]')?.dataset.barbaNamespace;e==="work"?(Ai(),yn(),Dn()):e==="archive"?(Gt(),yn(),Ea()):(Gt(),Dn(),e==="home"||e==="contact"?hc():yn())}Vn.init({transitions:[{name:"home-contact-fade",from:{namespace:["home","contact"]},to:{namespace:["home","contact"]},async leave(o){Yn();const e=o?.current?.container?.querySelectorAll("h1, h2, h3, h4, p, .text-reveal");e?.length&&await P.to(e,{opacity:0,duration:.4,ease:"power2.out"})},async enter(o){const t=o?.next?.container?.querySelectorAll("h1, h2, h3, h4, p, .text-reveal");t?.length&&(P.set(t,{opacity:0,clearProps:"transform"}),await P.fromTo(t,{opacity:0},{opacity:1,duration:.55,ease:"power2.out",stagger:.03}))},async after(o){Wn(o?.next?.namespace||o?.current?.namespace)}},{name:"default",async leave(o){o?.current?.namespace==="home"&&Gt(),o?.current?.namespace==="archive"&&Dn(),Yn(),await Vr()},async enter(){await Qn()},async once(){await Qn()}}]});Vn.hooks.once(o=>{Wn(o?.next?.namespace||o?.current?.namespace)});Vn.hooks.after(o=>{Wn(o?.next?.namespace||o?.current?.namespace)});
